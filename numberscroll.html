<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
    <meta content="width=device-width, initial-scale=1.0" name="viewport">
    <meta content="ie=edge" http-equiv="X-UA-Compatible">
    <title>4score</title>
    <link href='https://fonts.googleapis.com/css?family=Kalam' rel='stylesheet'>
     <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.1.0/papaparse.min.js"></script>

<style>

body {
      font-family: Arial, Helvetica, sans-serif;
      font-size: 20px;
     // height: 70vh;
     }

.grid-container-top {
                     display: grid;
                     grid-template-columns: auto auto auto auto auto;
                     width: 95vw;
                     background-color: white;
                    }

.grid-container-top > div {
                           background-color: white;
                           text-align: center;
                          }

.grid-container {
                 display: grid;
                 grid-template-columns: 15vw auto;
                }

.grid-container > div {
                       text-align: center;
                       //border: 2px solid purple;
                      }

.bignumber {
            grid-area: 1 / 1 / span 3 / span 1;
            display: flex;
            justify-content: center;
            align-items: center;
            //border: 2px solid purple;
            height: 20vh;
            //min-width: 400px;
            font-size: 12vh;
            font-weight: bold;
            //padding-top: 0.5vh;
            //padding-bottom: 0.5vh;
            //padding-left: 0.1vw;
            //padding-right: 0.5vw;
           }

.input, .slide {
                text-align: center;
               // padding: 10px 0; /* tb, lr*/
                font-size: 7vh;
                display: flex;
                justify-content: center;
                align-items: center;

               }

.player1name, .player2name, .player3name, .player4name {
                                                        color: silver;
                                                        font-size: 3vh;
                                                        font-style: italic;
                                                        display: flex;
                                                        flex-wrap: wrap;
                                                        justify-content: flex-end;
                                                        align-content: flex-end;
                                                        //border: 2px solid purple;
                                                        padding-top: 10px;
                                                        padding-right: 2px;
                                                       }


.player1points, .player2points, .player3points, .player4points {
                                                                color: silver;
                                                                font-size: 3vh;
                                                                font-style: italic;
                                                                display: flex;
                                                                justify-content: flex-end;
                                                                align-content: flex-end;
                                                                //border: 2px solid purple;
                                                                padding-bottom: 10px;
                                                                padding-right: 2px;
}











     

input[type="range"] {
  display: block;
  -webkit-appearance: none;
  background-color: gainsboro;
  width: 98%;
  height: 2px;
  border-radius: 25px;
  border: 1px solid gray;
  margin: 0 auto;
  outline: 0;
}
input[type="range"]::-webkit-slider-thumb {
  -webkit-appearance: none;
  background-color: crimson;
  width: 30px;
  height: 30px;
  border-radius: 50%;
  border: 2px solid dodgerBlue; //black;
  cursor: pointer;
  transition: .3s ease-in-out;
}â€‹
  input[type="range"]::-webkit-slider-thumb:hover {
    background-color: crimson;
    border: 2px solid black;
  }
  input[type="range"]::-webkit-slider-thumb:active {
    //transform: scale(1.6);
  }



  /* Style the button that is used to open and close the collapsible content */
      .collapsible {
        background-color: #eee;
        color: #444;
        cursor: pointer;
        padding: 18px;
        width: 100%;
        border: none;
        text-align: left;
        outline: none;
        font-size: 3vmax;
        border: 1px solid gray;
      }

      /* Style the collapsible content. Note: hidden by default */
      .content {
       //display: grid;
  grid-template-columns: auto auto auto auto;
  gap: 10px;
  background-color: white;

display: none;
      }



#p1, #pp1, #ppp1, #pppp1,
#p2, #pp2, #ppp2, #pppp2,
#p3, #pp3, #ppp3, #pppp3,
#p4, #pp4, #ppp4, #pppp4,
#p5, #pp5, #ppp5, #pppp5,
#p6, #pp6, #ppp6, #pppp6,
#p7, #pp7, #ppp7, #pppp7,
#p8, #pp8, #ppp8, #pppp8,
#p9, #pp9, #ppp9, #pppp9,
#p10, #pp10, #ppp10, #pppp10,
#p11, #pp11, #ppp11, #pppp11,
#p12, #pp12, #ppp12, #pppp12,
#p13, #pp13, #ppp13, #pppp13,
#p14, #pp14, #ppp14, #pppp14,
#p15, #pp15, #ppp15, #pppp15,
#p16, #pp16, #ppp16, #pppp16, 
#p17, #pp17, #ppp17, #pppp17,
#p18, #pp18, #ppp18, #pppp18,
#pf, #ppf, #pppf, #ppppf,
#pb, #ppb, #pppb, #ppppb,
#pt, #ppt, #pppt, #ppppt {
  font-family: 'Kalam';
  color: blue;
}

.small {
font-size: 2vh;
}






.scroll {
  max-height: 70vh;
  overflow:hidden;
    overflow-y: scroll;
    scrollbar-width: none; /* Firefox */
    -ms-overflow-style: none;  /* Internet Explorer 10+ */
}
.scroll::-webkit-scrollbar { /* WebKit */
    width: 0;
    height: 0;
}


#player4ballwrapper {
  float: right;
  width: 100%;
  height: 20vh;
  //padding: 1vmax;

  //border: 1px solid green;
  background: cyan;
  color: blue;
}

#player4ball {
font-size: 2.5vmax;
  float: right;
  height: 90%;
min-width: 20%;
padding: 1vh;
  //border: 1px solid red;
  color: blue;
}

#startbutton {
float: right;
font-size: 7vh; 
height: 100%;
min-width: 15vw;
}

nav {
  //margin:0 auto;
  width:100%;
  height:auto;
  display:inline-block;
  background:#37bc9b;
}

nav ul {
  margin:0;padding:0;
  list-style-type:none;
  float:left;
  display:inline-block; 
}

nav ul li {
  position:relative;
  margin:0 20px 0 0;
  float:left;
  display:inline-block;
}

li > a:after { content: '  >'; } /* Change this in order to change the Dropdown symbol */

li > a:only-child:after { content: ''; }

nav ul li a {
  padding:20px;
  display:inline-block;
  color:white;
  text-decoration:none;
}

nav ul li a:hover {
  opacity:0.5;
}

nav ul li ul {
  display:none;
  position:absolute;
  left:0;
  background:#37bc9b;
  float:left;
}

nav ul li ul li {
  width:100%;
  border-bottom:1px solid rgba(255,255,255,.3);
}

nav ul li:hover ul {
  display:block;
}




#t1 {
height: 100px;
}



</style>
</head>
<body>

<div id="firstscreen">
<nav>
  <ul>
    <li><a href="#">Select 4 Players</a>

      <ul class="scroll">
        <li><a href="javascript:output('Bryan Maddison')";">Bryan Maddison</a></li>
        <li><a href="javascript:output('Joe Fletcher')";">Joe Fletcher</a></li>
        <li><a href="javascript:output('Dale Aitkenhead')";">Dale Aitkenhead</a></li>
        <li><a href="javascript:output('Bob Toward')";">Bob Toward</a></li>
        <li><a href="javascript:output('Bryan Maddison')";">Bryan Maddison</a></li>
        <li><a href="javascript:output('Joe Fletcher')";">Joe Fletcher</a></li>
        <li><a href="javascript:output('Dale Aitkenhead')";">Dale Aitkenhead</a></li>
     
      </ul>
          
    </li>
    <li><a href="#">X</a></li>
  </ul>
</nav>

	
<div id="player4ballwrapper">

   <div id="player4ball"></div>

   <button id="startbutton">start</button>

</div>
<div></div>
<div>
<p>Select up to 4 players for your 4-ball.</p>	
<p>After pressing the start button, handicaps will be looked up and, if successful, scoring can commence.</p>	
<p>Select up to 4 players for your 4-ball.</p>	
<p>Select up to 4 players for your 4-ball.</p>	
<p>Select up to 4 players for your 4-ball.</p>	
<p>Select up to 4 players for your 4-ball.</p>	
</div>




</div>








<div id="all">
	<button type="button" class="collapsible" id="coll0" onclick="recordScores(this.id)">Recorded scores</button>
	<div class="content" id="content0">
		<div class="grid-container-top">
			<div class="small">hole</div>
			<div class="small" id="player1">player1</div>
			<div class="small" id="player2">player2</div>
			<div class="small" id="player3">player3</div>
			<div class="small" id="player4">player4</div>
			<div id="h1">1</div>
			<div id="p1">-</div>
			<div id="pp1">-</div>
			<div id="ppp1">-</div>
			<div id="pppp1">-</div>
			<div id="h2">2</div>
			<div id="p2">-</div>
			<div id="pp2">-</div>
			<div id="ppp2">-</div>
			<div id="pppp2">-</div>
			<div id="h3">3</div>
			<div id="p3">-</div>
			<div id="pp3">-</div>
			<div id="ppp3">-</div>
			<div id="pppp3">-</div>
			<div id="h4">4</div>
			<div id="p4">-</div>
			<div id="pp4">-</div>
			<div id="ppp4">-</div>
			<div id="pppp4">-</div>
			<div id="h5">5</div>
			<div id="p5">-</div>
			<div id="pp5">-</div>
			<div id="ppp5">-</div>
			<div id="pppp5">-</div>
			<div id="h6">6</div>
			<div id="p6">-</div>
			<div id="pp6">-</div>
			<div id="ppp6">-</div>
			<div id="pppp6">-</div>
			<div id="h7">7</div>
			<div id="p7">-</div>
			<div id="pp7">-</div>
			<div id="ppp7">-</div>
			<div id="pppp7">-</div>
			<div id="h8">8</div>
			<div id="p8">-</div>
			<div id="pp8">-</div>
			<div id="ppp8">-</div>
			<div id="pppp8">-</div>
			<div id="h9">9</div>
			<div id="p9">-</div>
			<div id="pp9">-</div>
			<div id="ppp9">-</div>
			<div id="pppp9">-</div>
			<div id="hf" class="totals">front</div>
			<div id="pf" class="totals">-</div>
			<div id="ppf" class="totals">-</div>
			<div id="pppf" class="totals">-</div>
			<div id="ppppf" class="totals">-</div>
			<div id="h10">10</div>
			<div id="p10">-</div>
			<div id="pp10">-</div>
			<div id="ppp10">-</div>
			<div id="pppp10">-</div>
			<div id="h11">11</div>
			<div id="p11">-</div>
			<div id="pp11">-</div>
			<div id="ppp11">-</div>
			<div id="pppp11">-</div>
			<div id="h12">12</div>
			<div id="p12">-</div>
			<div id="pp12">-</div>
			<div id="ppp12">-</div>
			<div id="pppp12">-</div>
			<div id="h13">13</div>
			<div id="p13">-</div>
			<div id="pp13">-</div>
			<div id="ppp13">-</div>
			<div id="pppp13">-</div>
			<div id="h14">14</div>
			<div id="p14">-</div>
			<div id="pp14">-</div>
			<div id="ppp14">-</div>
			<div id="pppp14">-</div>
			<div id="h15">15</div>
			<div id="p15">-</div>
			<div id="pp15">-</div>
			<div id="ppp15">-</div>
			<div id="pppp15">-</div>
			<div id="h16">16</div>
			<div id="p16">-</div>
			<div id="pp16">-</div>
			<div id="ppp16">-</div>
			<div id="pppp16">-</div>
			<div id="h17">17</div>
			<div id="p17">-</div>
			<div id="pp17">-</div>
			<div id="ppp17">-</div>
			<div id="pppp17">-</div>
			<div id="h18">18</div>
			<div id="p18">-</div>
			<div id="pp18">-</div>
			<div id="ppp18">-</div>
			<div id="pppp18">-</div>
			<div id="hb" class="totals">back</div>
			<div id="pb" class="totals">-</div>
			<div id="ppb" class="totals">-</div>
			<div id="pppb" class="totals">-</div>
			<div id="ppppb" class="totals">-</div>
			<div id="ht" class="totals">full</div>
			<div id="pt" class="totals">-</div>
			<div id="ppt" class="totals">-</div>
			<div id="pppt" class="totals">-</div>
			<div id="ppppt" class="totals">-</div>
		</div> <!-- grid container -->
	</div> <!-- content -->

	<button type="button" class="collapsible" id="coll1" onclick="recordScores(this.id)">hole 1<img src="tick1.png" alt="done" id="h1img" style="height: 3vmax; width: 3vmax; float: right;"></button>
<div class="content" id="content1">
<div class="grid-container">
			<div class="bignumber" id="value1a">0</div>
			<div class="player1name">Player 1</div>
			<div class="slide">
				<input type="range" class="input" id="input1a" oninput="update(this.id)" min="0" max="9" step="1" value="0">
			</div>
			<div class="player1points" id="points1a">no points</div>
</div>
<div class="grid-container">
			<div class="bignumber" id="value1b">0</div>
			<div class="player2name">Player 2</div>
			<div class="slide">
				<input type="range" class="input" id="input1b" oninput="update(this.id)" min="0" max="9" step="1" value="0">
			</div>
			<div class="player2points" id="points1b">no points</div>
</div> <!-- grid container -->
<div class="grid-container">
			<div class="bignumber" id="value1c">0</div>
			<div class="player3name">Player 3</div>
			<div class="slide">
				<input type="range" class="input" id="input1c" oninput="update(this.id)" min="0" max="9" step="1" value="0">
			</div>
			<div class="player3points" id="points1c">no points</div>
</div> <!-- grid container -->
<div class="grid-container">
			<div class="bignumber" id="value1d">0</div>
			<div class="player4name">Player 4</div>
			<div class="slide">
				<input type="range" class="input" id="input1d" oninput="update(this.id)" min="0" max="9" step="1" value="0">
			</div>
			<div class="player4points" id="points1d">no points</div>
</div> <!-- grid container -->

</div> <!-- content -->				
				
	<button type="button" class="collapsible" id="coll2" onclick="recordScores(this.id)">hole 1<img src="tick1.png" alt="done" id="h2img" style="height: 3vmax; width: 3vmax; float: right;"></button>
<div class="content" id="content2">
<div class="grid-container">
			<div class="bignumber" id="value2a">0</div>
			<div class="player1name">Player 1</div>
			<div class="slide">
				<input type="range" class="input" id="input2a" oninput="update(this.id)" min="0" max="9" step="1" value="0">
			</div>
			<div class="player1points" id="points2a">no points</div>
</div>
<div class="grid-container">
			<div class="bignumber" id="value2b">0</div>
			<div class="player2name">Player 2</div>
			<div class="slide">
				<input type="range" class="input" id="input2b" oninput="update(this.id)" min="0" max="9" step="1" value="0">
			</div>
			<div class="player2points" id="points2b">no points</div>
</div> <!-- grid container -->
<div class="grid-container">
			<div class="bignumber" id="value2c">0</div>
			<div class="player3name">Player 3</div>
			<div class="slide">
				<input type="range" class="input" id="input2c" oninput="update(this.id)" min="0" max="9" step="1" value="0">
			</div>
			<div class="player3points" id="points2c">no points</div>
</div> <!-- grid container -->
<div class="grid-container">
			<div class="bignumber" id="value2d">0</div>
			<div class="player4name">Player 4</div>
			<div class="slide">
				<input type="range" class="input" id="input2d" oninput="update(this.id)" min="0" max="9" step="1" value="0">
			</div>
			<div class="player4points" id="points2d">no points</div>
</div> <!-- grid container -->
</div> <!-- content -->


	<button type="button" class="collapsible" id="coll3" onclick="recordScores(this.id)">hole 1<img src="tick1.png" alt="done" id="h3img" style="height: 3vmax; width: 3vmax; float: right;"></button>
<div class="content" id="content3">
<div class="grid-container">
			<div class="bignumber" id="value3a">0</div>
			<div class="player1name">Player 1</div>
			<div class="slide">
				<input type="range" class="input" id="input3a" oninput="update(this.id)" min="0" max="9" step="1" value="0">
			</div>
			<div class="player1points" id="points3a">no points</div>
</div>
<div class="grid-container">
			<div class="bignumber" id="value3b">0</div>
			<div class="player2name">Player 2</div>
			<div class="slide">
				<input type="range" class="input" id="input3b" oninput="update(this.id)" min="0" max="9" step="1" value="0">
			</div>
			<div class="player2points" id="points3b">no points</div>
</div> <!-- grid container -->
<div class="grid-container">
			<div class="bignumber" id="value3c">0</div>
			<div class="player3name">Player 3</div>
			<div class="slide">
				<input type="range" class="input" id="input3c" oninput="update(this.id)" min="0" max="9" step="1" value="0">
			</div>
			<div class="player3points" id="points3c">no points</div>
</div> <!-- grid container -->
<div class="grid-container">
			<div class="bignumber" id="value3d">0</div>
			<div class="player4name">Player 4</div>
			<div class="slide">
				<input type="range" class="input" id="input3d" oninput="update(this.id)" min="0" max="9" step="1" value="0">
			</div>
			<div class="player4points" id="points3d">no points</div>
</div> <!-- grid container -->
</div> <!-- content -->

	<button type="button" class="collapsible" id="coll4" onclick="recordScores(this.id)">hole 1<img src="tick1.png" alt="done" id="h4img" style="height: 3vmax; width: 3vmax; float: right;"></button>
<div class="content" id="content4">
<div class="grid-container">
			<div class="bignumber" id="value4a">0</div>
			<div class="player1name">Player 1</div>
			<div class="slide">
				<input type="range" class="input" id="input4a" oninput="update(this.id)" min="0" max="9" step="1" value="0">
			</div>
			<div class="player1points" id="points4a">no points</div>
</div>
<div class="grid-container">
			<div class="bignumber" id="value4b">0</div>
			<div class="player2name">Player 2</div>
			<div class="slide">
				<input type="range" class="input" id="input4b" oninput="update(this.id)" min="0" max="9" step="1" value="0">
			</div>
			<div class="player2points" id="points4b">no points</div>
</div> <!-- grid container -->
<div class="grid-container">
			<div class="bignumber" id="value4c">0</div>
			<div class="player3name">Player 3</div>
			<div class="slide">
				<input type="range" class="input" id="input4c" oninput="update(this.id)" min="0" max="9" step="1" value="0">
			</div>
			<div class="player3points" id="points4c">no points</div>
</div> <!-- grid container -->
<div class="grid-container">
			<div class="bignumber" id="value4d">0</div>
			<div class="player4name">Player 4</div>
			<div class="slide">
				<input type="range" class="input" id="input4d" oninput="update(this.id)" min="0" max="9" step="1" value="0">
			</div>
			<div class="player4points" id="points4d">no points</div>
</div> <!-- grid container -->


</div> <!-- content -->	

				
				
				
				
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
</div> <!-- all -->
<script>




/*
       localStorage structure
comp
p1name
p2name
p3name
p4name
p1hcp
p2hcp
p3hcp
p4hcp
p1h1score
..to..
p4h18score

*/












var msglist = "";
var msglistcount = 0;


comp = "from somewhere"

// either start again or retrieve from localStorage  

player1name = "Bryan Maddison"
player2name = "Bob Toward"
player3name = "Stephen Alldridge"
player4name = "Joe Fletcher"
player1hcp = 29;
player2hcp = 16;
player3hcp = 9;
player4hcp = 15;




// hole, par, si
arrOldCourse = [
	[0, 0, 0],
	[1, 5, 10],
	[2, 4, 6],
	[3, 3, 18],
	[4, 5, 4],
	[5, 3, 16],
	[6, 4, 2],
	[7, 4, 14],
	[8, 4, 8],
	[9, 4, 12],
	[10, 4, 5],
	[11, 3, 13],
	[12, 4, 15],
	[13, 4, 1],
	[14, 5, 7],
	[15, 3, 11],
	[16, 5, 9],
	[17, 4, 3],
	[18, 5, 17]
];
course = JSON.parse(JSON.stringify(arrOldCourse));


player1name = "Bryan Maddison"
player2name = "Bob Toward"
player3name = "Stephen Alldridge"
player4name = "Joe Fletcher"
	// shorten player name
s1 = player1name.split(" ")
shortPlayer1name = s1[0] + " " + s1[1].substring(0, 1);
shortPlayer1name = shortPlayer1name.replace("Stephen", "Steve")
shortPlayer1name = shortPlayer1name.replace("Malcolm", "Mal")
document.getElementById("player1").innerText = shortPlayer1name;
s1 = player2name.split(" ")
shortPlayer2name = s1[0] + " " + s1[1].substring(0, 1);
shortPlayer2name = shortPlayer2name.replace("Stephen", "Steve")
shortPlayer2name = shortPlayer2name.replace("Malcolm", "Mal")
document.getElementById("player2").innerText = shortPlayer2name;
s1 = player3name.split(" ")
shortPlayer3name = s1[0] + " " + s1[1].substring(0, 1);
shortPlayer3name = shortPlayer3name.replace("Stephen", "Steve")
shortPlayer3name = shortPlayer3name.replace("Malcolm", "Mal")
document.getElementById("player3").innerText = shortPlayer3name;
s1 = player4name.split(" ")
shortPlayer4name = s1[0] + " " + s1[1].substring(0, 1);
shortPlayer4name = shortPlayer4name.replace("Stephen", "Steve")
shortPlayer4name = shortPlayer4name.replace("Malcolm", "Mal")
document.getElementById("player4").innerText = shortPlayer4name;
// get these by lookup xxxxx
player1hcp = 29;
player2hcp = 16;
player3hcp = 9;
player4hcp = 15;

// install green ticks then hide them
for(i = 1; i <= 4; i++) {
	document.getElementById("coll" + i).innerHTML = '<img src="tick1.png" alt="done" id="h' + i + 'img" style="height: 3vmax; width: 3vmax; float: right;">' + "hole " + course[i][0] + ", par " + course[i][1] + ", si " + course[i][2]
	document.getElementById("h" + i + "img").style.display = "none"
}
var collection = document.getElementsByClassName("player1name");
for(i = 0; i < collection.length; i++) {
	collection[i].innerText = player1name;
}
var collection = document.getElementsByClassName("player2name");
for(i = 0; i < collection.length; i++) {
	collection[i].innerText = player2name;
}
var collection = document.getElementsByClassName("player3name");
for(i = 0; i < collection.length; i++) {
	collection[i].innerText = player3name;
}
var collection = document.getElementsByClassName("player4name");
for(i = 0; i < collection.length; i++) {
	collection[i].innerText = player4name;
}












//==============
// recovery bit
//==============
// do recover - why ?
// loop through all scores and retrieve valid ones
for(i = 1; i <= 18; i++) {
    for(j = 1; j <= 4; j++) {
        if ("p" + j + "h" + i + "score" in localStorage) {
            recoverRecordedScores("p" + j + "h" + i + "score")
        }
    }
}
// redo totals
totalsCalc()
//=====================
// end of recovery bit
//=====================







function recordScores(id) {
	//eg. id = coll1
	
		// if content is open, close and reset things
	if(document.getElementById(id.replace("coll", "content")).style.display == "initial") {
		for(i = 0; i <= 4; i++) {
			// hide content, but show buttons  
			document.getElementById("content" + i).style.display = "none"
			document.getElementById("coll" + i).style.display = "block"
		}
		// at this point, save scores
		// player 1
		var h = id.replace("coll", "");
		var s1 = document.getElementById(id.replace("coll", "input") + "a").value
		var p1 = pointsCalc(player1hcp, course[h][1], course[h][2], s1)
		document.getElementById(id.replace("coll", "p")).innerText = s1 + "/" + p1
		// player 2
		var s2 = document.getElementById(id.replace("coll", "input") + "b").value
		var p2 = pointsCalc(player1hcp, course[h][1], course[h][2], s2)
		document.getElementById(id.replace("coll", "pp")).innerText = s2 + "/" + p2
		// player 3
		var s3 = document.getElementById(id.replace("coll", "input") + "c").value
		var p3 = pointsCalc(player1hcp, course[h][1], course[h][2], s3)
		document.getElementById(id.replace("coll", "ppp")).innerText = s3 + "/" + p3
		// player 4
		var s4 = document.getElementById(id.replace("coll", "input") + "d").value
		var p4 = pointsCalc(player1hcp, course[h][1], course[h][2], s4)
		document.getElementById(id.replace("coll", "pppp")).innerText = s4 + "/" + p4
		// to localStorage eg p1h1score,5
		localStorage.setItem("p1h" + h +"score", s1 + "/" + p1)
		localStorage.setItem("p2h" + h +"score", s2 + "/" + p2)
		localStorage.setItem("p3h" + h +"score", s3 + "/" + p3)
		localStorage.setItem("p4h" + h +"score", s4 + "/" + p4)
	
	} else {
	
	//eg. id = coll1
	
		// close all
		for(i = 0; i <= 4; i++) {
			document.getElementById("content" + i).style.display = "none"
			document.getElementById("coll" + i).style.display = "none"
		}
		// show single button
		document.getElementById(id).style.display = "block"
			// show related content
		var newid = id.replace("coll", "content");
		document.getElementById(newid).style.display = "initial";
		//document.getElementById(newid).style.display = "block"     
		// show green tick bevause score recorded   
		document.getElementById(id.replace("coll", "h") + "img").style.display = "block"
			
	}
	
	
	
	
	
}



// convert scores to stableford points
function pointsCalc(hcp, par, si, score) {
	allowance = 0;
	if(score == 0) {
		return 0;
	} else {
		// allowance   
		if(hcp >= si) {
			allowance = 1;
		}
		if(hcp >= (18 + si)) {
			allowance = 2;
		}
		if(hcp >= (36 + si)) {
			allowance = 3;
		}
		// points
		var points = (par + allowance + 2) - score;
		// remove negative numbers
		if(points < 0) {
			points = 0;
		}
	
		return points;
	}
}

function totalsCalc() {
	p1front = 0
	p2front = 0
	p3front = 0
	p4front = 0
	p1frontpoints = 0
	p2frontpoints = 0
	p3frontpoints = 0
	p4frontpoints = 0
	p1back = 0
	p2back = 0
	p3back = 0
	p4back = 0
	p1backpoints = 0
	p2backpoints = 0
	p3backpoints = 0
	p4backpoints = 0
	for(var i = 1; i <= 9; i++) {
		var tempp1txt = document.getElementById("p" + i).innerText
		if(!(tempp1txt == "-")) {
			tempp1 = tempp1txt.split("/");
			p1front += parseInt(tempp1[0])
			p1frontpoints += parseInt(tempp1[1])
		}
		var tempp2txt = document.getElementById("pp" + i).innerText
		if(!(tempp2txt == "-")) {
			tempp2 = tempp2txt.split("/");
			p2front += parseInt(tempp2[0])
			p2frontpoints += parseInt(tempp2[1])
		}
		var tempp3txt = document.getElementById("ppp" + i).innerText
		if(!(tempp3txt == "-")) {
			tempp3 = tempp3txt.split("/");
			p3front += parseInt(tempp3[0])
			p3frontpoints += parseInt(tempp3[1])
		}
		var tempp4txt = document.getElementById("pppp" + i).innerText
		if(!(tempp4txt == "-")) {
			tempp4 = tempp4txt.split("/");
			p4front += parseInt(tempp4[0])
			p4frontpoints += parseInt(tempp4[1])
		}
	}
	for(var i = 10; i <= 18; i++) {
		var tempp1txt = document.getElementById("p" + i).innerText
		if(!(tempp1txt == "-")) {
			tempp1 = tempp1txt.split("/");
			p1back += parseInt(tempp1[0])
			p1backpoints += parseInt(tempp1[1])
		}
		var tempp2txt = document.getElementById("pp" + i).innerText
		if(!(tempp2txt == "-")) {
			tempp2 = tempp2txt.split("/");
			p2back += parseInt(tempp2[0])
			p2backpoints += parseInt(tempp2[1])
		}
		var tempp3txt = document.getElementById("ppp" + i).innerText
		if(!(tempp3txt == "-")) {
			tempp3 = tempp3txt.split("/");
			p3back += parseInt(tempp3[0])
			p3backpoints += parseInt(tempp3[1])
		}
		var tempp4txt = document.getElementById("pppp" + i).innerText
		if(!(tempp4txt == "-")) {
			tempp4 = tempp4txt.split("/");
			p4back += parseInt(tempp4[0])
			p4backpoints += parseInt(tempp4[1])
		}
	}
	document.getElementById("pf").innerText = p1front.toString() + " (" + p1frontpoints.toString() + ")";
	document.getElementById("ppf").innerText = p2front.toString() + " (" + p2frontpoints.toString() + ")";
	document.getElementById("pppf").innerText = p3front.toString() + " (" + p3frontpoints.toString() + ")";
	document.getElementById("ppppf").innerText = p4front.toString() + " (" + p4frontpoints.toString() + ")";
	document.getElementById("pb").innerText = p1back.toString() + " (" + p1backpoints.toString() + ")";
	document.getElementById("ppb").innerText = p2back.toString() + " (" + p2backpoints.toString() + ")";
	document.getElementById("pppb").innerText = p3back.toString() + " (" + p3backpoints.toString() + ")";
	document.getElementById("ppppb").innerText = p4back.toString() + " (" + p4backpoints.toString() + ")";
	document.getElementById("pt").innerText = (p1front + p1back).toString() + " (" + (p1frontpoints + p1backpoints).toString() + ")";
	document.getElementById("ppt").innerText = (p2front + p2back).toString() + " (" + (p2frontpoints + p2backpoints).toString() + ")";
	document.getElementById("pppt").innerText = (p3front + p3back).toString() + " (" + (p3frontpoints + p3backpoints).toString() + ")";
	document.getElementById("ppppt").innerText = (p4front + p4back).toString() + " (" + (p4frontpoints + p4backpoints).toString() + ")";
}
// runs when slider moves
// update big number     
// update text saying "points 7" etc.      
function update(id) {


	//eg. id = input1a
	// update big number
	var tempscore = document.getElementById(id).value;
	document.getElementById(id.replace("input", "value")).innerHTML = tempscore;
	//var n = tempscore - 2;
	// these to sort out
	hcp = 25;
	par = 4;
	si = 12;
	var temp1 = id.substring(id.length - 1); // gives a etc.
	var temp2 = id.replace("input", ""); // gives 1a etc.
	var temp3 = temp2.substring(0, temp2.length - 1); // gives 1 etc.
	
	
	if(temp1 == "a") {
		var n = pointsCalc(player1hcp, course[temp3][1], course[temp3][2], tempscore);
	}
	if(temp1 == "b") {
		var n = pointsCalc(player2hcp, course[temp3][1], course[temp3][2], tempscore);
	}
	if(temp1 == "c") {
		var n = pointsCalc(player3hcp, course[temp3][1], course[temp3][2], tempscore);
	}
	if(temp1 == "d") {
		var n = pointsCalc(player4hcp, course[temp3][1], course[temp3][2], tempscore);
	}
	

	if(n == 1) {
		var nstring = n + " point";
	} else {
		var nstring = n + " points"
	}
	if(n <= 0) {
		var nstring = "no points";
	}

	document.getElementById(id.replace("input", "points")).innerText = nstring;
}      
     
 
    
    
// recover functions ===================================================================


// runs per player, per hole
function recoverRecordedScores(lshole) {
	//eg. p1h1score

	templshole = localStorage.getItem(lshole)
	// get hole
	temphole = lshole.substr(3).replace("score","")
	// get score
	tempscore = templshole.substr(0,1)
	// get points
	temppoints = templshole.substr(2,1)
	// update slider value (eg input3a) with score
	if (lshole.substr(1,1) == "1") {
	    tempplayer = "a"
	    ps = "p"
	}
	if (lshole.substr(1,1) == "2") {
	    tempplayer = "b"
	    ps = "pp" 
	}
	if (lshole.substr(1,1) == "3") {
	    tempplayer = "c"
	    ps = "ppp" 
	}
	if (lshole.substr(1,1) == "4") {
	    tempplayer = "d"
	    ps = "pppp" 
	}
	// run processes
	// at this point, save scores
	document.getElementById("input" + temphole + tempplayer).value = tempscore
	// bignumber
	document.getElementById("value" + temphole + tempplayer).innerText = tempscore
	
	// calc points
	var p1 = pointsCalc(player1hcp, course[temphole][1], course[temphole][2], tempscore)
	// update recorded scores
	document.getElementById(ps + temphole).innerText = tempscore + "/" + p1
	
	// update msg about points
	if(p1 == 1) {
		var nstring = p1 + " point";
	} else {
		var nstring = p1 + " points"
	}
	if(p1 <= 0) {
		var nstring = "no points";
	}
	
	document.getElementById("points" + temphole + tempplayer).innerText = nstring;
	
	
	
	// do tick
	document.getElementById("h" + temphole + "img").style.display = "block"
	
				
}

	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
  //=============================================================
    // function downloader()
    // - gets data to create arrays for players, hcps, comps
    // - papaparse uses HTML5's filereader API to get csv file
    //=============================================================  
    function downloader() {
      // setupcsv
      var public_hcp_url = "https://docs.google.com/spreadsheets/d/e/2PACX-1vR5UUmQIocKfgsPnXGZZW-kBqNNEgOIm8r4Wdn9wOWqAXHht-1iZCPSDcalB0bhAIUUR5Me7fBufma_/pub?gid=581380869&single=true&output=csv";
      var strng1 = "strng1"; // player
      var strng2 = "strng2"; // hcp
      var strng3 = "strng3"; // comp
      i=0;  
       
      console.log("downloading msg")
      //showDownloadingInfoMsg()
      
      try {
        // if it fails after 20 seconds, put up error message
        setTimeout(function() {
          if (!(strng2.length) > 0) {
            alert("failed");
          }
        }, 20000);
        Papa.parse(public_hcp_url, {
          download: true,
          header: true,
          step: function(results, parser) {
             strng1 = results.data.players;
             // add row
             console.log(strng1)
             arrPlayers.push([strng1,0]);
             //strng3 = results.data.comps;
             //arrComps[i] = strng3;
             i++
          },
          complete: function() {
          // global player
          // replace button name
          element = document.getElementById("dropbtn");
          element.innerText = player;
          start();
              }
          })
       
      } // end try
      catch (err) {
        console.log(err.message);
      }
    }

    //=============================================================
    // run downloder() function 
    //=============================================================
    downloader();
    
    console.log(arrPlayers[2])
    
    //=============================================================
    // function toggleDropdown()
    // - show player name choices
    //=============================================================  
    function toggleDropdown() {
      // When the user clicks on the button, toggle between hiding and showing the dropdown content
      document.getElementById("playersDropdown").classList.toggle("show");
    }

   	
	
	
	
  // name selected, do stuff
    function dropSelected(playerName) {

      if (playerName == "reset list") {
        resetNames();
      } else {
        // retrieve dropdown info
        var arrOptions = JSON.parse(localStorage.dropdown);
        for (var k = 0; k < arrOptions.length; k++) {
          if (arrOptions[k][0] == playerName) {
            found = true;
            pos = k;
          }
        }
        // change color on selection
        document.getElementById("myLink" + pos.toString()).style.color = "blue";
        document.getElementById("myLink" + pos.toString()).style.background = "lightBlue";
        // update player choice
        player2submit = document.getElementById("myLink" + pos.toString()).innerText;
        if (pos >= 0) {
          // increment number of times chosen
          var tc = parseInt(arrOptions[pos][1]) + 1;
          arrOptions[pos][1] = tc;
          // store new order
          //=====LocalStorage.dropdown====================
          localStorage.dropdown = JSON.stringify(arrOptions);
          //==============================================
          // global player
          player = playerName;
          //=====LocalStorage.guessPlayer=====
          localStorage.guessPlayer = player;
          //=============================
        }
        
        // replace button name
        element = document.getElementById("dropbtn");
        element.innerText = player;
        // update player choices
        // reset hole scores
        //=====LocalStorage.player=====
        localStorage.player = player;
        //=============================
        //=====LocalStorage.guessPlayer=====
        localStorage.guessPlayer = player;
        //=============================
        player2submit = player;
        // close dropdown
        var dropdowns = document.getElementsByClassName("dropdown-content");
        var i;
        for (i = 0; i < dropdowns.length; i++) {
          var openDropdown = dropdowns[i];
          if (openDropdown.classList.contains('show')) {
            openDropdown.classList.remove('show');
          }
        }
        doGetHCP();
      }
    }	
	
	
	
	
	
	
	
	
	
	
 //=============================================================
    // function start()
    // - initialise everything and do checks etc.
    //=============================================================  
    function start() {
    // check for any new members etc.
    // setup local dropdown if not there
    if (!("dropdown" in localStorage)) {
      //=====LocalStorage.dropdown===================
      localStorage.dropdown = JSON.stringify(arrPlayers);
      //=============================================
    }
    // default notsame to false
    var notsame = false;
    if ("dropdown" in localStorage) {
      // retrieve dropdown info
      var arrOptions = JSON.parse(localStorage.dropdown);
      // see if different number of items
      if (arrOptions.length !== arrPlayers.length) {
        notsame = true;
      } else {
        // Comparing each element of your array
        for (var i = 0; i < arrOptions.length; i++) {
          // see if items are different
          if (arrOptions[i][0] !== arrPlayers[i][0]) {
            notsame = true;
          }
        }
      }
    };

    // if different
    if (notsame) {
      // option is original, arrPlayers is new
      // update new with numbers from original
      for (var i = 0; i < arrOptions.length; i++) {
        for (var j = 0; j < arrPlayers.length; j++) {
          if (arrOptions[i][0] == arrPlayers[j][0]) {
            arrPlayers[j][1] = arrOptions[i][1];
          }
        }
      }
      arrOptions = JSON.parse(JSON.stringify(arrPlayers));
      //=====LocalStorage.dropdown====================
      localStorage.dropdown = JSON.stringify(arrOptions);
      //==============================================
    }

    // bring most commonly selected to the top
    arrOptions.sort(compareSecondColumn);
    // create player dropdown
    var select = document.getElementById("playersDropdown");
    // this is what is created
    //<a id="myLink1" href="#" onclick='dropSelected(this.innerText);return false;'>Graham Airey</a>
    //
    for (var i = 0; i < arrOptions.length; i++) {
      var el = document.createElement("a");
      el.id = "myLink" + (i);
      el.setAttribute("onclick", "dropSelected(this.innerText);return false;");
      el.setAttribute("href", "#");
      el.innerText = arrOptions[i][0];
      select.appendChild(el);
      if (arrOptions[i][1] > 0) {
        document.getElementById("myLink" + (i)).style.color = "blue";
        document.getElementById("myLink" + (i)).style.background = "lightBlue";
      }
    }

    // Close the dropdown if the user clicks outside of it
    window.onclick = function (event) {
      if (!event.target.matches('.dropbtn')) {
        var dropdowns = document.getElementsByClassName("dropdown-content");
        var i;
        for (i = 0; i < dropdowns.length; i++) {
          var openDropdown = dropdowns[i];
          if (openDropdown.classList.contains('show')) {
            openDropdown.classList.remove('show');
          }
        }
      }
    };
    // get todays date eg 26 June
    dd = new Date();
    // get date number and format it
    d1 = dd.getDate();
    if (d1 < 10) {
      d1 = "0" + d1;
    }
    // get month and format it
    d2 = dd.getMonth();

    if (d2 == 0) {
      m = "January";
    }
    if (d2 == 1) {
      m = "February";
    }
    if (d2 == 2) {
      m = "March";
    }
    if (d2 == 3) {
      m = "April";
    }
    if (d2 == 4) {
      m = "May";
    }
    if (d2 == 5) {
      m = "June";
    }
    if (d2 == 6) {
      m = "July";
    }
    if (d2 == 7) {
      m = "August";
    }
    if (d2 == 8) {
      m = "September";
    }
    if (d2 == 9) {
      m = "October";
    }
    if (d2 == 10) {
      m = "November";
    }
    if (d2 == 11) {
      m = "December";
    }
    dateToday = d1 + " " + m;
    // tidy localStorage if out of date to allow new "blank" setup
    if ("comp" in localStorage) {
      if (localStorage.comp.indexOf(dateToday) == -1) {
        // tidy
        clearCache();
      }
    }

    // recover data if dates match
    // this allows data to be kept over refreshes
    if ("comp" in localStorage) {
      if (localStorage.comp.indexOf(dateToday) > -1) {
        // recover
        recoverFromLocalStorage();
      }
    }

    // see if it is a compday and if so find comp and course from array list
    for (i = 0; i < arrComps.length; i++) {
      // if today - eg. "22 June" in arrComps list then compday = "yes"
      if (arrComps[i].indexOf(d1 + " " + m) > -1) {
        compday = "yes";
        comp = arrComps[i];
   
        if (arrComps[i].indexOf("Lakes") > -1) {
          // global course
          course = "Lakes";
          // localStorage course
          localStorage.course = "Lakes";
        }
        if (arrComps[i].indexOf("Dawson") > -1) {
          // global course
          course = "Dawson";
          // localStorage course
          localStorage.course = "Dawson";
        }
        if (arrComps[i].indexOf("OldCourse") > -1) {
          // global course
          course = "OldCourse";
          // localStorage course
          localStorage.course = "OldCourse";
        }
      }
    }

    if (compday == "yes") {
      localStorage.comp = comp;
    }
  
    // if not a compday find out what course is played and create a comp
    if (compday == "no") {
      if (!("comp" in localStorage)) {
        //showCourseChoice();
        returnToMenu();
      }
  
    }
    // recover	
    if (comp == localStorage.comp) {
      recoverFromLocalStorage();
    }
    // show comp info message for 3 seconds
    if ("comp" in localStorage) {
      showCompMessage();
    }
    } // end function start()

	
	
	
	function output(msg) {
	msglistcount++
	if (msglistcount > 4) {
	    console.log("too many players")
	} else {
	    if (msglist == "") {
	        msglist = msg;
	    } else {    
	        msglist += "#" + msg
	    }
	    console.log(msglist)
	}
	
	msglistx = msglist + "#none#none#none#none"
	arr1 = msglistx.split("#");
	newmsglist = "Player 1: " + arr1[0] + "<br>" +
	             "Player 2: " + arr1[1] + "<br>" +
	             "Player 3: " + arr1[2] + "<br>" +
	             "Player 4: " + arr1[3]
	document.getElementById("player4ball").innerHTML = newmsglist
	}
	

    
     
</script>



</body>
</html>  
