
<!DOCTYPE html>
<html style="font-size: 16px; font-family:Arial, Helvetica, sans-serif;">
<head lang="en">
<meta charset="utf-8" />
<meta name="viewport" content=
"width=device-width, initial-scale=1, shrink-to-fit=yes" />
<meta name="description" content="Matchplay Pairs" />
<meta name="author" content="Bryan M" />
<title>Matchplay Pairs</title>
<link rel="icon" type="image/x-icon" href="favicon.ico" />
<script src="jquery-3.6.0.min.js" type="text/javascript">
</script>
<style>

body {
background: Gray;
font-size: 14px;
}

#MyMenuA, #MyMenuB {
background: DodgerBlue;
color: white;
width: 200px;
padding: 10px;
font-size: 18px;
border: none;
cursor: pointer;
border-radius: 15px;
border: 2px solid darkSlateGray;
box-shadow: 10px 10px 25px black;
text-shadow: 0px 4px 3px rgba(0,0,0,0.4),
             0px 8px 13px rgba(0,0,0,0.1),
             0px 18px 23px rgba(0,0,0,0.1);
}

#playerinput, #matchinput, #my-response-iframe, #my-form {
display: none;
}

#submitButton, #return2results {
   
background: DodgerBlue;
color: white;
width: 200px;
padding: 10px;
font-size: 18px;
border: none;
cursor: pointer;
border-radius: 15px;
border: 2px solid darkSlateGray;
box-shadow: 10px 10px 25px black;
text-shadow: 0px 4px 3px rgba(0,0,0,0.4),
             0px 8px 13px rgba(0,0,0,0.1),
             0px 18px 23px rgba(0,0,0,0.1);
}

#playerinput, #matchinput {
display: none;
}

#lastm {
   font-size: 12px;
   color: lightGray;
}
 
</style>
</head>
<body>
<font size=12; color="#ccc";>Matchplay pairs 2023</font>
<br><br>
This is the score entry for the Matchplay Pairs. Each match is "labelled" (eg. "match 19" etc.) to identify it.
<br><br>
Select the names of the winning pair and which match was played. The match label (eg "match 19") will be replaced with the names of the winning pair as submitted.
<br><br>
<select id="MyMenuA" onchange="getname()">
</select>
<br><br><br>

<select id="MyMenuB" onchange="getmatch()">
</select>
<br><br><br>
 .. then use the Submit button.

<div id="playerinput"></div>
<div id="matchinput"></div>

<br><br>

<form id="my-form" 
    target="my-response-iframe" 
    action="https://docs.google.com/forms/d/e/1FAIpQLSdGX7TnhAupg-jCVA7PMqu9lOdSwuJIaRNTwyM3t2bLwonbzg/formResponse" 
    method="post" 
    onSubmit="JavaScript:buttonSubmit()">
        <!-- match -->
        <input type="text" 
        name="entry.1937014137" 
        value="default" 
        id="mx1937014137" >
        <!-- player -->
        <input type="text" 
        name="entry.957190470" 
        value="default" 
        id="mx957190470" >
               
    <input type="submit">
</form>



<iframe id="my-response-iframe" 
    name="my-response-iframe"
    src="https://docs.google.com/forms/d/e/1FAIpQLSdGX7TnhAupg-jCVA7PMqu9lOdSwuJIaRNTwyM3t2bLwonbzg/viewform?embedded=true" 
    width="640" 
    height="407" 
    frameborder="0" 
    marginheight="0" 
    marginwidth="0">
    Loadingâ€¦
</iframe>


<button id="submitButton" onclick="buttonSubmit()">Submit</button>
<div id="submitConfirm"></div>

<br><br>
Updates can take up to 5 minutes to complete.
<br><br>


<input type="button" id="return2results" onclick="location.href='https://docs.google.com/spreadsheets/d/e/2PACX-1vTQbZkdF1OJD8cxfuD0JmF2AxGaq-vybZxqod-7awCYd3PUSLVKkC-A7Fx8H6AiN49_UxrYwFZlkE9y/pubhtml?gid=1697062311&single=true';" value="Return to pairs" />

<br><br><br><br>

<script>
//var d = new Date(document.lastModified);
//document.getElementById("lastm").innerText = "last updated: " + d.toGMTString('en-UK')







var x =""

var arr = ["dummy",
"Richard Hedley & Brian Simpson",
"B Maddison & R Connelly",
"R Ireland & R Woodcock",
"P Holleran & Craig Caesar",
"A Davison & D Nelson",
"N Tait & J Jackson",
"J E Smith & W French",
"E Saddler & M Edwards",
"R Green & tba",
"T Smith & J Matthews",
"S Alldridge & D Aitkenhead",
"J Fletcher & J Dean",
"B Hill & B Craggs",
"N Coxon & M Riddell",
"K Belshaw & R Thompson"
]  








var xx =""
var arr1 = ["dummy",
"match1",
"match2",
"match3",
"match4",
"match5",
"match6",
"match7",
"match8",
"match9",
"match10",
"match11",
"match12",
"match13",
"match14",
"match15",
"match16",
"match17",
"match18",
"match19",
"match20",
"match21",
"match22", 
"match23",
"match24",
"match25",
"match26",
"match27",
"match28",
"match29",
"match30",          
"winner"            
"winners"
 ]

// player
x = '<option value="0">select pairing</option>'
for (let i = 1; i < arr.length; i++) {
   x = x + '<option value="' + i + '">' + arr[i] + '</option>'
}

var e = document.getElementById("MyMenuA");
e.innerHTML = x

// match
xx = '<option value="0">select match</option>'
for (let ii = 1; ii < arr1.length; ii++) {
   xx = xx + '<option value="' + ii + '">' + arr1[ii] + '</option>'
}

var ee = document.getElementById("MyMenuB");
ee.innerHTML = xx
// initialise player and match
//document.getElementById("playerinput").innerText = arr[1];
//document.getElementById("matchinput").innerText = arr1[1];


function getname() {
var e = document.getElementById("MyMenuA");
//var strUser = e.value;
var strUser1 = e.options[e.selectedIndex].text;
var e1 = document.getElementById("playerinput");
e1.innerText = strUser1
var e2 = document.getElementById("selectedA");
e2.innerText = strUser1 + " selected"
}


function getmatch() {
var e = document.getElementById("MyMenuB");
//var strUser = e.value;
var strUser1 = e.options[e.selectedIndex].text;
var e1 = document.getElementById("matchinput");
e1.innerText = strUser1
var e2 = document.getElementById("selectedA");
e2.innerText = strUser1 + " selected"
}





function buttonSubmit() {
  if (document.getElementById("submitButton").innerText == "Submit") {
    // do submit stuff here
    var ok = "yes";
   
    var s1 = document.getElementById("matchinput").innerText;
    if (s1.length  > 0) { 
        document.getElementById("mx1937014137").value = s1; 
    } else {
        ok = "no";
    }
    
    var s2 = document.getElementById("playerinput").innerText;
    if (s2.length  > 0) { 
        document.getElementById("mx957190470").value = s2; 
    } else {
        ok = "no";
    }
    
    if (ok == "yes") {
      // press the form submit button
      document.forms[0].submit()
        
    sub = document.getElementById("submitButton");
    sub.style.backgroundColor = "blue";
    sub.innerText = "Submitted";
    
    
    } else {
        alert("missing data so no submit");
    }
    
    
    
  }
}



// set the target on the form to point to a hidden iframe
// some browsers need the target set via JavaScript, no idea why...
document.getElementById('my-form').target = 'my-response-iframe';
// detect when the iframe reloads
var iframe = document.getElementById('my-response-iframe');

if (iframe) {
iframe.onload = function () {
// at this point the iframe reloads which is equivalent to a success.
       
//alert("success");
var s1 = document.getElementById("playerinput").innerText; 
if (s1.length > 0) {
    
    
 // wait - probably not required
  // but helps with timestamp etc.
  const milliseconds = 1000;
  const date = Date.now();
  let currentDate = null;
  do {
    currentDate = Date.now();
  } while (currentDate - date < milliseconds);    
    
    sub = document.getElementById("submitButton");
    sub.style.backgroundColor = "blue";
    sub.innerText = "Updated OK"; 
    
}       
}
}
   
</script>
<br><br>
</body>
</html>

