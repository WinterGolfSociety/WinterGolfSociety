<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no" />
	<title>winter 2023</title>
	<meta content="Bryan M" name="author" />
	<link href="favicon.ico" rel="icon" type="image/x-icon" />
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
	<link href='https://fonts.googleapis.com/css?family=Kalam' rel='stylesheet'>
	<style>
	html {
		width: 100%;
		height: 300%;
	}
	
	* {
		margin: 0;
		padding: 0;
	}
	
	body {
		background-color: dodgerBlue;
		width: 100%;
		height: 100%;
		/* 100% of 300% */
		color: white;
	}
	/* dropdown */
	
	.dropbtn,
	.submit {
		font-size: 5vh;
		display: inline-block;
		padding-top: 3vh;
		padding-bottom: 3vh;
		padding-left: 1vw;
		border: 2px solid blue;
		font-family: Arial, Helvetica, sans-serif;
		border-radius: 10px;
		width: 91%;
	}
	
	.dropdown {
		position: relative;
		display: inline-block;
	}
	
	.dropdown-content {
		display: none;
		position: absolute;
		background-color: #f1f1f1;
		min-width: 160px;
		overflow: auto;
		box-shadow: 0px 8px 16px 0px rgba(0, 0, 0, 0.2);
		z-index: 1;
		border-radius: 3px;
		box-shadow: 10px 10px 25px black;
		max-height: 80vh;
	}
	
	.dropdown-content a {
		font-family: Arial, Helvetica, sans-serif;
		color: gray;
		padding: 12px 16px;
		text-decoration: none;
		display: block;
		font-size: 5vh;
	}
	
	.show {
		display: block;
	}
	/* end of dropdown */
	/* hide forms */
	
	#my-form,
	#my-response-iframe {
		display: none;
		height: 1000px;
		width: 600px;
	}
	
	.holder1 {
		width: 100%;
		height: calc(10% / 3);
		background: dodgerBlue;
	}
	
	.holder2 {
		width: 100%;
		background: dodgerBlue;
	}
	
	.holder3 {
		width: 100%;
		height: calc(100% / 3);
		background: cyan;
	}
	
	.minus,
	.plus {
		font-size: 5vh;
		display: inline-block;
		width: 15%;
		height: 10vh;
		line-height: 10vh;
		padding-left: 5%;
		padding-right: 5%;
		border: 2px solid blue;
		text-align: center;
		font-family: Arial, Helvetica, sans-serif;
		border-radius: 10px;
	}
	
	.score {
		font-size: 5vh;
		display: inline-block;
		width: 10%;
		height: 10vh;
		line-height: 10vh;
		padding-left: 5%;
		padding-right: 5%;
		border: 2px solid blue;
		text-align: center;
		font-family: Arial, Helvetica, sans-serif;
		border-radius: 10px;
	}
	
	.hole {
		font-size: 5vh;
		display: inline-block;
		width: 15%;
		height: 10vh;
		line-height: 10vh;
		text-align: center;
		border: 2px solid blue;
		background: dodgerBlue;
		font-family: Arial, Helvetica, sans-serif;
		border-radius: 10px;
	}
	
	#spacer1 {
		background: dodgerBlue;
		height: 3vh;
	}
	
	#spacer2 {
		background: dodgerBlue;
		height: 1vh;
	}
	
	#inputlist {
		font-size: 4vh;
		color: cyan;
		font-family: Arial, Helvetica, sans-serif;
	}
	</style>
</head>

<body>
	<div class="holder1">
		<div onclick="toggleDropdown();" class="dropbtn" id="dropbtn">select player</div>
		<div id="playersDropdown" class="dropdown-content"> <a id="myLink1" href="#" onclick='dropSelected(this.innerText);return false;'>Dale</a> <a id="myLink2" href="#" onclick='dropSelected(this.innerText);return false;'>Stephen</a> <a id="myLink3" href="#" onclick='dropSelected(this.innerText);return false;'>Andy</a> <a id="myLink4" href="#" onclick='dropSelected(this.innerText);return false;'>John</a> <a id="myLink5" href="#" onclick='dropSelected(this.innerText);return false;'>Joe</a> <a id="myLink6" href="#" onclick='dropSelected(this.innerText);return false;'>Barry</a> <a id="myLink7" href="#" onclick='dropSelected(this.innerText);return false;'>Tom</a> <a id="myLink8" href="#" onclick='dropSelected(this.innerText);return false;'>Bryan</a> <a id="myLink9" href="#" onclick='dropSelected(this.innerText);return false;'>Ray</a> <a id="myLink10" href="#" onclick='dropSelected(this.innerText);return false;'>Gus</a> </div>
	</div>
	<div id="spacer1"></div>
	<div class="holder2">
		<div class="hole">1</div>
		<div class="minus" onclick="decrementScore('score1')">-</div>
		<div class="score" id="score1">0</div>
		<div class="plus" onclick="incrementScore('score1')">+</div>
		<br>
		<div class="hole">2</div>
		<div class="minus" onclick="decrementScore('score2')">-</div>
		<div class="score" id="score2">0</div>
		<div class="plus" onclick="incrementScore('score2')">+</div>
		<br>
		<div class="hole">3</div>
		<div class="minus" onclick="decrementScore('score3')">-</div>
		<div class="score" id="score3">0</div>
		<div class="plus" onclick="incrementScore('score3')">+</div>
		<br>
		<div class="hole">4</div>
		<div class="minus" onclick="decrementScore('score4')">-</div>
		<div class="score" id="score4">0</div>
		<div class="plus" onclick="incrementScore('score4')">+</div>
		<br>
		<div class="hole">5</div>
		<div class="minus" onclick="decrementScore('score5')">-</div>
		<div class="score" id="score5">0</div>
		<div class="plus" onclick="incrementScore('score5')">+</div>
		<br>
		<div class="hole">6</div>
		<div class="minus" onclick="decrementScore('score6')">-</div>
		<div class="score" id="score6">0</div>
		<div class="plus" onclick="incrementScore('score6')">+</div>
		<br>
		<div class="hole">7</div>
		<div class="minus" onclick="decrementScore('score7')">-</div>
		<div class="score" id="score7">0</div>
		<div class="plus" onclick="incrementScore('score7')">+</div>
		<br>
		<div class="hole">8</div>
		<div class="minus" onclick="decrementScore('score8')">-</div>
		<div class="score" id="score8">0</div>
		<div class="plus" onclick="incrementScore('score8')">+</div>
		<br>
		<div class="hole">9</div>
		<div class="minus" onclick="decrementScore('score9')">-</div>
		<div class="score" id="score9">0</div>
		<div class="plus" onclick="incrementScore('score9')">+</div>
		<br>
		<div class="hole">10</div>
		<div class="minus" onclick="decrementScore('score10')">-</div>
		<div class="score" id="score10">0</div>
		<div class="plus" onclick="incrementScore('score10')">+</div>
		<br>
		<div class="hole">11</div>
		<div class="minus" onclick="decrementScore('score11')">-</div>
		<div class="score" id="score11">0</div>
		<div class="plus" onclick="incrementScore('score11')">+</div>
		<br>
		<div class="hole">12</div>
		<div class="minus" onclick="decrementScore('score12')">-</div>
		<div class="score" id="score12">0</div>
		<div class="plus" onclick="incrementScore('score12')">+</div>
		<br>
		<div class="hole">13</div>
		<div class="minus" onclick="decrementScore('score13')">-</div>
		<div class="score" id="score13">0</div>
		<div class="plus" onclick="incrementScore('score13')">+</div>
		<br>
		<div class="hole">14</div>
		<div class="minus" onclick="decrementScore('score14')">-</div>
		<div class="score" id="score14">0</div>
		<div class="plus" onclick="incrementScore('score14')">+</div>
		<br>
		<div class="hole">15</div>
		<div class="minus" onclick="decrementScore('score15')">-</div>
		<div class="score" id="score15">0</div>
		<div class="plus" onclick="incrementScore('score15')">+</div>
		<br>
		<div class="hole">16</div>
		<div class="minus" onclick="decrementScore('score16')">-</div>
		<div class="score" id="score16">0</div>
		<div class="plus" onclick="incrementScore('score16')">+</div>
		<br>
		<div class="hole">17</div>
		<div class="minus" onclick="decrementScore('score17')">-</div>
		<div class="score" id="score17">0</div>
		<div class="plus" onclick="incrementScore('score17')">+</div>
		<br>
		<div class="hole">18</div>
		<div class="minus" onclick="decrementScore('score18')">-</div>
		<div class="score" id="score18">0</div>
		<div class="plus" onclick="incrementScore('score18')">+</div>
		<br>
		<div class="submit" id="submit" onclick="submitForm()">Submit</div>
		<div id="spacer2"></div>
		<br>
		<br>
		<div id="inputlist"></div>
	</div>
	<!-- form to construct data prior to submit -->
	<form action="https://docs.google.com/forms/d/e/1FAIpQLSdu4_reuXey4t0fd3O4AktzAXmkCEIcAfF7KM4x4KA7IzHoSQ/formResponse" id="my-form" method="post" name="my-form" target="my-response-iframe">
		<input id='mx1433824128' name='entry.1433824128' type='text' value='player'>
		<input id='mx1119360478' name='entry.1119360478' type='text' value='day'>
		<input id='mx83976721' name='entry.83976721' type='text' value='totalpoints'>
		<input id='mx717166862' name='entry.717166862' type='text' value='par3points'>
		<input id='mx611960104' name='entry.611960104' type='text' value='1'>
		<input id='mx692291793' name='entry.692291793' type='text' value='2'>
		<input id='mx222515663' name='entry.222515663' type='text' value='3'>
		<input id='mx1510982441' name='entry.1510982441' type='text' value='4'>
		<input id='mx1337748054' name='entry.1337748054' type='text' value='5'>
		<input id='mx263917982' name='entry.263917982' type='text' value='6'>
		<input id='mx1424664264' name='entry.1424664264' type='text' value='7'>
		<input id='mx1504721910' name='entry.1504721910' type='text' value='8'>
		<input id='mx522611935' name='entry.522611935' type='text' value='9'>
		<input id='mx402860323' name='entry.402860323' type='text' value='10'>
		<input id='mx950207658' name='entry.950207658' type='text' value='11'>
		<input id='mx355906431' name='entry.355906431' type='text' value='12'>
		<input id='mx1294150167' name='entry.1294150167' type='text' value='13'>
		<input id='mx495755048' name='entry.495755048' type='text' value='14'>
		<input id='mx1398537006' name='entry.1398537006' type='text' value='15'>
		<input id='mx2056271267' name='entry.2056271267' type='text' value='16'>
		<input id='mx1717958306' name='entry.1717958306' type='text' value='17'>
		<input id='mx281700482' name='entry.281700482' type='text' value='18'>
		<input id='mx906938391' name='entry.906938391' type='text' value='1'>
		<input id='mx1347034770' name='entry.1347034770' type='text' value='2'>
		<input id='mx787445339' name='entry.787445339' type='text' value='3'>
		<input id='mx1392094547' name='entry.1392094547' type='text' value='4'>
		<input id='mx333086688' name='entry.333086688' type='text' value='5'>
		<input id='mx320493086' name='entry.320493086' type='text' value='6'>
		<input id='mx876067808' name='entry.876067808' type='text' value='7'>
		<input id='mx1450911454' name='entry.1450911454' type='text' value='8'>
		<input id='mx1009912575' name='entry.1009912575' type='text' value='9'>
		<input id='mx2008107656' name='entry.2008107656' type='text' value='10'>
		<input id='mx1704095880' name='entry.1704095880' type='text' value='11'>
		<input id='mx463852632' name='entry.463852632' type='text' value='12'>
		<input id='mx1315504899' name='entry.1315504899' type='text' value='13'>
		<input id='mx1618707425' name='entry.1618707425' type='text' value='14'>
		<input id='mx636864079' name='entry.636864079' type='text' value='15'>
		<input id='mx1569872152' name='entry.1569872152' type='text' value='16'>
		<input id='mx1343492377' name='entry.1343492377' type='text' value='17'>
		<input id='mx1137608322' name='entry.1137608322' type='text' value='18'>
		<input type="submit"> </form>
	<!-- google iframe inserted here - invisible -->
	<iframe height="20" id="my-response-iframe" name="my-response-iframe" src="https://docs.google.com/forms/d/e/1FAIpQLSdu4_reuXey4t0fd3O4AktzAXmkCEIcAfF7KM4x4KA7IzHoSQ/viewform?embedded=true" width="60"></iframe>
	<script>
	// prevent highlighting by accident
	onselectstart = (e) => {
		e.preventDefault()
	}
	var arrPlayers = [];
	var arrHcps = [];
	var arrDone = [];
	getData();
	var today = new Date();
	var day = today.getDay();
	var player = "";
	var hcp = "";
	var inputlist = "";
	var arrdow = ["none", "Monday", "Tuesday", "Wednesday", "Thursday"]
	var dow = arrdow[day];
	// 1 = monday
	if(day == 1) {
		//pitreavie
		arrCourse = [
			[0, 0, 0],
			[1, 5, 6],
			[2, 5, 12],
			[3, 3, 2],
			[4, 4, 8],
			[5, 4, 16],
			[6, 3, 10],
			[7, 4, 4],
			[8, 4, 14],
			[9, 4, 18],
			[10, 4, 7],
			[11, 4, 17],
			[12, 3, 15],
			[13, 4, 1],
			[14, 4, 5],
			[15, 4, 13],
			[16, 3, 9],
			[17, 4, 3],
			[18, 4, 11]
		]
	}
	// 2 = tuesday, 4 - thursday
	if(day == 2 || day == 4) {
		//montgomery
		arrCourse = [
			[0, 0, 0],
			[1, 3, 13],
			[2, 4, 7],
			[3, 5, 9],
			[4, 3, 17],
			[5, 4, 15],
			[6, 4, 3],
			[7, 4, 11],
			[8, 4, 5],
			[9, 4, 1],
			[10, 4, 10],
			[11, 5, 6],
			[12, 4, 14],
			[13, 4, 2],
			[14, 3, 16],
			[15, 5, 12],
			[16, 4, 8],
			[17, 3, 18],
			[18, 4, 4]
		]
	}
	// 3 = wednesday
	if(day == 3) {
		//bruce
		arrCourse = [
			[0, 0, 0],
			[1, 4, 11],
			[2, 4, 17],
			[3, 3, 5],
			[4, 5, 7],
			[5, 5, 13],
			[6, 4, 1],
			[7, 4, 15],
			[8, 5, 8],
			[9, 4, 3],
			[10, 4, 4],
			[11, 3, 10],
			[12, 5, 16],
			[13, 3, 14],
			[14, 4, 8],
			[15, 4, 2],
			[16, 3, 18],
			[17, 4, 6],
			[18, 4, 12]
		]
	}
	// dropdown
	//=============================================================
	// function toggleDropdown()
	// - show player name choices
	//=============================================================  
	function toggleDropdown() {
		// When the user clicks on the button, toggle between hiding and showing the dropdown content
		document.getElementById("playersDropdown").classList.toggle("show");
	}
	//=====================================================
	// Close the dropdown if the user clicks outside of it
	//=====================================================
	window.onclick = function(event) {
		if(!event.target.matches('.dropbtn')) {
			var dropdowns = document.getElementsByClassName("dropdown-content");
			var i;
			for(i = 0; i < dropdowns.length; i++) {
				var openDropdown = dropdowns[i];
				if(openDropdown.classList.contains('show')) {
					openDropdown.classList.remove('show');
				}
			}
		}
	};
	//===========================
	// name selected, do stuff
	//===========================
	function dropSelected(playerName) {
		// retrieve player and hcp info
		for(var k = 0; k < arrPlayers.length; k++) {
			if(arrPlayers[k] == playerName) {
				hcp = arrHcps[k];
				player = arrPlayers[k];
			}
		}

		// global player
		player = playerName;
		//}
		// replace player button name
		document.getElementById("dropbtn").innerText = player + " " + hcp;
		// replace hcp buttom number is in doGetHCP()
		// update localStorage
		localStorage.wwplayer = player;
		localStorage.wwhcp = hcp;
		// close dropdown
		var dropdowns = document.getElementsByClassName("dropdown-content");
		var i;
		for(i = 0; i < dropdowns.length; i++) {
			var openDropdown = dropdowns[i];
			if(openDropdown.classList.contains('show')) {
				openDropdown.classList.remove('show');
			}
		}
		//	doGetHCP();
	}

	//=============================================================
	// function incrementScore()
	// - plus button handler
	//=============================================================  
	// + button for hole scores
	function incrementScore(id) {
		incScore = document.getElementById(id).innerText;
		document.getElementById(id).innerText = ++incScore;
		if(++incScore >= 0) {
			--incScore;
		}
	}
	///=============================================================
	// function decrementScore()
	// - minus button handler
	//=============================================================  
	function decrementScore(id) {
		incScore = document.getElementById(id).innerText;
		if(incScore > 0) {
			document.getElementById(id).innerText = --incScore;
		}
	}
	//=============================================================
	// function pointsCalc()
	// - convert scores to stableford points
	//=============================================================  
	function pointsCalc(hcp, par, si, score) {
		allowance = 0;
		if(score == 0) {
			return 0;
		} else {
			// allowance   
			if(hcp >= si) {
				allowance = 1;
			}
			if(hcp >= (18 + si)) {
				allowance = 2;
			}
			if(hcp >= (36 + si)) {
				allowance = 3;
			}
			// points
			var points = (par + allowance + 2) - score;
			// remove negative numbers
			if(points < 0) {
				points = 0;
			}
			return points;
		}
	}
	//=============================================================
	// function submitForm()
	// - send info from HTML form to google form
	//=============================================================  
	function submitForm() {
		// get the relevant info into a form
		// find points
		// pointsCalc(hcp, par, si, score)
		var totalpoints = 0;
		var totalpar3 = 0;
		for(var i = 1; i <= 18; i++) {
			totalpoints += pointsCalc(hcp, arrCourse[i][1], arrCourse[i][2], document.getElementById("score" + i).innerText);
			if(arrCourse[i][1] == 3) {
				totalpar3 += parseInt(pointsCalc(hcp, arrCourse[i][1], arrCourse[i][2], document.getElementById("score" + i).innerText));
			}
		}
		document.getElementById('mx1433824128').value = player;
		document.getElementById('mx1119360478').value = dow;
		document.getElementById('mx83976721').value = totalpoints;
		document.getElementById('mx717166862').value = totalpar3;
		// strokes
		document.getElementById('mx611960104').value = document.getElementById("score1").innerText;
		document.getElementById('mx692291793').value = document.getElementById("score2").innerText;
		document.getElementById('mx222515663').value = document.getElementById("score3").innerText;
		document.getElementById('mx1510982441').value = document.getElementById("score4").innerText;
		document.getElementById('mx1337748054').value = document.getElementById("score5").innerText;
		document.getElementById('mx263917982').value = document.getElementById("score6").innerText;
		document.getElementById('mx1424664264').value = document.getElementById("score7").innerText;
		document.getElementById('mx1504721910').value = document.getElementById("score8").innerText;
		document.getElementById('mx522611935').value = document.getElementById("score9").innerText;
		document.getElementById('mx402860323').value = document.getElementById("score10").innerText;
		document.getElementById('mx950207658').value = document.getElementById("score11").innerText;
		document.getElementById('mx355906431').value = document.getElementById("score12").innerText;
		document.getElementById('mx1294150167').value = document.getElementById("score13").innerText;
		document.getElementById('mx495755048').value = document.getElementById("score14").innerText;
		document.getElementById('mx1398537006').value = document.getElementById("score15").innerText;
		document.getElementById('mx2056271267').value = document.getElementById("score16").innerText;
		document.getElementById('mx1717958306').value = document.getElementById("score17").innerText;
		document.getElementById('mx281700482').value = document.getElementById("score18").innerText;
		// points
		document.getElementById('mx906938391').value = pointsCalc(hcp, arrCourse[1][1], arrCourse[1][2], document.getElementById("score1").innerText);
		document.getElementById('mx1347034770').value = pointsCalc(hcp, arrCourse[2][1], arrCourse[2][2], document.getElementById("score2").innerText);
		document.getElementById('mx787445339').value = pointsCalc(hcp, arrCourse[3][1], arrCourse[3][2], document.getElementById("score3").innerText);
		document.getElementById('mx1392094547').value = pointsCalc(hcp, arrCourse[4][1], arrCourse[4][2], document.getElementById("score4").innerText);
		document.getElementById('mx333086688').value = pointsCalc(hcp, arrCourse[5][1], arrCourse[5][2], document.getElementById("score5").innerText);
		document.getElementById('mx320493086').value = pointsCalc(hcp, arrCourse[6][1], arrCourse[6][2], document.getElementById("score6").innerText);
		document.getElementById('mx876067808').value = pointsCalc(hcp, arrCourse[7][1], arrCourse[7][2], document.getElementById("score7").innerText);
		document.getElementById('mx1450911454').value = pointsCalc(hcp, arrCourse[8][1], arrCourse[8][2], document.getElementById("score8").innerText);
		document.getElementById('mx1009912575').value = pointsCalc(hcp, arrCourse[9][1], arrCourse[9][2], document.getElementById("score9").innerText);
		document.getElementById('mx2008107656').value = pointsCalc(hcp, arrCourse[10][1], arrCourse[10][2], document.getElementById("score10").innerText);
		document.getElementById('mx1704095880').value = pointsCalc(hcp, arrCourse[11][1], arrCourse[11][2], document.getElementById("score11").innerText);
		document.getElementById('mx463852632').value = pointsCalc(hcp, arrCourse[12][1], arrCourse[12][2], document.getElementById("score12").innerText);
		document.getElementById('mx1315504899').value = pointsCalc(hcp, arrCourse[13][1], arrCourse[13][2], document.getElementById("score13").innerText);
		document.getElementById('mx1618707425').value = pointsCalc(hcp, arrCourse[14][1], arrCourse[14][2], document.getElementById("score14").innerText);
		document.getElementById('mx636864079').value = pointsCalc(hcp, arrCourse[15][1], arrCourse[15][2], document.getElementById("score15").innerText);
		document.getElementById('mx1569872152').value = pointsCalc(hcp, arrCourse[16][1], arrCourse[16][2], document.getElementById("score16").innerText);
		document.getElementById('mx1343492377').value = pointsCalc(hcp, arrCourse[17][1], arrCourse[17][2], document.getElementById("score17").innerText);
		document.getElementById('mx1137608322').value = pointsCalc(hcp, arrCourse[18][1], arrCourse[18][2], document.getElementById("score18").innerText);
		//===== submit data ==========
		//============================
		document.forms[0].submit();
		//alert("submit")
		// add player and points
		arrDone.push([player, totalpoints])
			// sort
		arrDone.sort(sortFunction);
		// empty previous list
		inputlist = "";
		// create new list
		for(var j = 0; j < arrDone.length; j++) {
			inputlist += arrDone[j][0] + " " + arrDone[j][1] + "<br>"
		}
		// display list
		document.getElementById("inputlist").innerHTML = inputlist
		document.getElementById("submit").style.background = "blue";
		setTimeout(function() {
			document.getElementById("submit").style.background = "dodgerBlue"
		}, 3000)
	}
	// sort by highest 2nd array item
	function sortFunction(a, b) {
		if(a[1] === b[1]) {
			return 0;
		} else {
			return(a[1] > b[1]) ? -1 : 1;
		}
	}
	async function getData() {
		var dataStream = await fetch("https://opensheet.elk.sh/15qcwJy_qzGnqKrre_Z3NUs38Nt1S9sfgkT6H9uZNIxQ/hcps")
		var resultsarray = await dataStream.json()
			// get rid of blanks in array by creating new arrays
		for(var i = 0; i < resultsarray.length; i++) {
			if(resultsarray[i].player.length > 2) {
				// comps now contains modified comps
				// comps is usualy a different length to players and hcps
				// so contains empty items that need to be removed
				arrPlayers.push(resultsarray[i].player);
				arrHcps.push(resultsarray[i].hcp);
				//sparseArrComps.push(resultsarray[i].comps);
			}
		}
	}

	function afterGetData() {
		alert(arrPlayers[1] + " " + arrHcps[1])
	}
	</script>
</body>

</html>

