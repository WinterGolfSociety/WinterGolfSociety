<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no" />
	<title>winter 2023</title>
	<meta content="Bryan M" name="author" />
	<meta name="theme-color" content="#2F4F4F">
	<link href="wintericon.png" rel="icon" type="image/x-icon" />
	<link rel="apple-touch-icon" sizes="180x180" href="wintericon.png"/>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
	<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.1.0/papaparse.min.js"></script>
	<link href='https://fonts.googleapis.com/css?family=Kalam' rel='stylesheet'>
	<style>
	* {
		margin: 0;
		padding: 0;
	}
	
	body {
	height: 90vh;
		background-color: darkSlateGray;
		overflow-y: scroll;
                scrollbar-width: none; /* Firefox */
                -ms-overflow-style: none;  /* Internet Explorer 10+ */
        }
        
        body::-webkit-scrollbar { /* WebKit */
               width: 0;
               height: 0;
        }	

	
	.square_menu_icon {
		display: block;
		position: absolute;
		//overflow: hidden;
		margin: 0;
		padding: 0;
		width: 45px;
		height: 45px;
		font-size: 0;
		text-indent: -9999px;
		appearance: none;
		box-shadow: none;
		border-radius: none;
		border: none;
		cursor: pointer;
		transition: background 0.3s;
		top: 57%;
		left: 50%;
		transform: translate(-50%, -50%);
		background-color: transparent;
		z-index: 99;
	}
	
	.square_menu_icon:focus {
		outline: none;
	}
	
	.square_menu_icon span {
		display: block;
		position: absolute;
		top: 15px;
		left: 0;
		right: 0;
		height: 7px;
		background: #fff;
	}
	
	.square_menu_icon span:before,
	.square_menu_icon span:after {
		position: absolute;
		display: block;
		left: 0;
		width: 100%;
		height: 7px;
		background-color: #fff;
		content: "";
	}
	
	.square_menu_icon span:before {
		top: -14px;
	}
	
	.square_menu_icon span:after {
		bottom: -14px;
	}
	
	.square_menu_icon-X span {
		transition: background 0s 0.3s;
	}
	
	.square_menu_icon-X span:before,
	.square_menu_icon-X span:after {
		transition-duration: 0.3s, 0.3s;
		transition-delay: 0.3s, 0s;
	}
	
	.square_menu_icon-X span:before {
		transition-property: top, transform;
	}
	
	.square_menu_icon-X span:after {
		transition-property: bottom, transform;
	}
	
	.square_menu_icon-X.is-active span {
		background: none;
	}
	
	.square_menu_icon-X.is-active span:before {
		top: 0;
		transform: rotate(45deg);
	}
	
	.square_menu_icon-X.is-active span:after {
		bottom: 0;
		transform: rotate(-45deg);
	}
	
	.square_menu_icon-X.is-active span:before,
	.square_menu_icon-X.is-active span:after {
		transition-delay: 0s, 0.3s;
	}
	
	nav {
		position: absolute;
		top: 80px; //100px;
		left: 80px; //100px;
		transform: translate(-50%, -50%);
		border-radius: 5px;
		width: 75px;
		height: 75px;
		z-index: 4;
		border: 5px solid white;
	}
	
	.bubble_menu {
		position: absolute;
		top: 50%;
		left: 50%;
		transform: translate(-50%, -50%);
		background-color: dodgerBlue;
		width: 75px;
		height: 75px;
		z-index: 4;
		cursor: pointer;
	}
	
	#one,
	#two,
	#three,
	#four,
	#five {
		position: absolute;
		top: 50%;
		left: 50%;
		transform: translate(-50%, -50%);
		border-radius: 5px;
		width: 65px;
		height: 65px;
		z-index: 3;
		text-align: center;
		border: 5px solid white;
		cursor: pointer;
	}
	
	#one {
		background-color: salmon;
		display: flex;
		justify-content: center;
	}
	
	#two {
		background-color: darkKhaki;
		display: flex;
		justify-content: center;
	}
	
	#three {
		background-color: orchid;
		display: flex;
		justify-content: center;
	}
	
	#four {
		background-color: lightSteelBlue;
		display: flex;
		justify-content: center;
	}
	
	#five {
		background-color: cyan;
		display: flex;
		justify-content: center;
	}
	
	.title {
		color: white;
		font-family: 'Kalam';
		font-size: 40px;
	}
	
	section {
		width: 100vw;
		//height: 100%;
		position: absolute;
	}
	
	.start {
		top: 0;
		left: 0;
		text-align: center;
	}
	
	.content {
		width: 80%;
		height: 100%;
		opacity: 1;
		margin: 0 auto;
	}
	
	.title {
		color: white;
		font-family: 'Kalam';
		font-size: 40px;
	}
	
	h2 {
		//font-size: 50px;
		//color: #111111;
		margin-top: 160px;
	}
	
	#onetxt,
	#twotxt,
	#threetxt,
	#fourtxt,
	#fivetxt {
		margin: auto;
		font-size: 23px;
		color: blue;
		font-family: 'Kalam';
	}
	
	#onetxt {
		margin: auto;
		font-size: 20px;
		color: blue;
		font-family: 'Kalam';
	}
	
	#twotxt {
		margin: auto;
		font-size: 20px;
		color: blue;
		font-family: 'Kalam';
	}
	
	#threetxt {
		margin: auto;
		font-size: 20px;
		color: blue;
		font-family: 'Kalam';
	}
	
	#fourtxt {
		margin: auto;
		font-size: 20px;
		color: blue;
		font-family: 'Kalam';
	}
	
	#fivetxt {
		margin: auto;
		font-size: 20px;
		color: blue;
		font-family: 'Kalam';
	}
	
	#one:active {
		border: 5px solid salmon;
	}
	
	#two:active {
		border: 5px solid darkKhaki;
	}
	
	#three:active {
		border: 5px solid orchid;
	}
	
	#four:active {
		border: 5px solid lightSteelBlue;
	}
	
	#five:active {
		border: 5px solid cyan;
	}
	
	nav:active {
		border: 5px solid dodgerBlue;
	}
	
	.dates {
		font-family: 'Kalam';
		color: darkGray;
		font-size: 13px;
	}
	
	#upcoming {
		float: left;
	}
	
	#dcomp1 {
		float: left;
		padding left: 5vw;
	}
	
	#img {
		transition-duration: 0.4s;
	}
	
	#img.half {
		transform: scale(5);
	}
	
	
	.contentinfo {
	font-family: 'Kalam';
		color: white;
		font-size: 12px;
		
		//width: 100%;
	}
	
	
	
	</style>

	<body>
		<nav id="nav">
			<div class="bubble_menu" id="icon">
				<button class="square_menu_icon square_menu_icon-X"> <span></span> </button>
			</div>
			<div class="bubble" id="one" onclick="doOne();"> <a id="onetxt">HCPs</a> </div>
			<div class="bubble" id="two" onclick="doTwo();"> <a id="twotxt">Score entry</a> </div>
			<div class="bubble" id="three" onclick="doThree();"> <a id="threetxt">Twos</a> </div>
			<div class="bubble" id="four" onclick="doFour();"> <a id="fourtxt">Results</a> </div>
			<div class="bubble" id="five" onclick="doFive();"> <a id="fivetxt">Leader board</a> </div>
		</nav>
		<section class="start">
			<div class="content">
			<h2 class="title">Winter golf</h2>
				<div class="contentinfo">
				<br>
				hcps, score entry, twos, results, leaderboard
				</div>
				<br>
				<div class="datescontent"> <a class="dates" id="upcoming">upcoming ...</a>
					<br>
					<br>
					<a class="dates" id="xdcomp1"></a>
				</div>
    <br>
				<div class="qrcode" id="qrcode"> <img id="img" onclick="enlarge(this.id);" style="padding-right: 20px; float: right; border: 0; height: 30px; width: 30px;" src="frame.png" alt="qr"> </div>
			</div>
			
			    <br>
			
			
		</section>
	</body>
	<script>
    // global arrays
    var arrPlayers = []
    var arrHcp = []
    var arrComps = []
    var sparseArrComps = []
    var arrPlayersOld = []
    var arrHcpOld = []

        // menu code
        var isTop = true;
	var menuIsOpen = false;
	var menuIcon = $('.square_menu_icon');
	var bubblemenu = $('.bubble_menu');
	var one = $('#one');
	var two = $('#two');
	var three = $('#three');
	var four = $('#four');
	var five = $('#five');
	// menuIcon.click(function() {
	bubblemenu.click(function() {
		if(isTop === true) {
			$('#nav').animate({
				top: '50%',
				left: '50%'
			}, 400);
			$('.content').animate({
				opacity: '0'
			}, 700);
			showBubbles();
			isTop = false;
		} else {
			if(menuIsOpen === false) {
				showBubbles();
			} else {
				hideBubbles();
			}
		}
	});

	function showBubbles() {
		menuIcon.addClass('is-active');
		one.animate({
			opacity: '1'
		}, 10);
		two.animate({
			opacity: '1'
		}, 10);
		three.animate({
			opacity: '1'
		}, 10);
		four.animate({
			opacity: '1'
		}, 10);
	        five.animate({
			opacity: '1'
		}, 10);

		// middle right
		// right
		one.animate({
			top: '37px'
		}, 300);	
		// middle right
		// right
		one.animate({
			left: '140px'
		}, 300);
		
		// bottom middle
		// bottom	
		two.animate({
			top: '140px'
		}, 300);
		// bottom middle
		// left	
		two.animate({
			left: '37px'
		}, 300);
		// middle left
                // top
		three.animate({
			top: '37px'
		}, 300);
		// middle left
                // left
		three.animate({
			left: '-65px'
		}, 300);
		// top middle
		// top
		four.animate({
			top: '-65px'
		}, 300);
		// top middle
		// middle
		four.animate({
			left: '37px'
		}, 300);
		 // top left
		// top
		five.animate({
			top: '-65px'
		}, 300);
	        // top left
		// left
		five.animate({
			left: '-65px'
		}, 300);
		
		
		menuIsOpen = true;
		// hide pressbutton
		$("#pressbutton").html("");
	}

	function hideBubbles() {
		// add 500ms delay to change X to hamburger
		setTimeout(function() {
			menuIcon.removeClass('is-active');
		}, 500);
		setTimeout(function() {
			// move x icon back to hamburger
			$('#nav').animate({
				top: '80px',
				left: '80px'
			}, 400);
			// fade background title
			$('.content').animate({
				opacity: '1'
			}, 1500);
		}, 400);
		// move menu items
		
		one.animate({
			top: '50%'
		}, 200);
		one.animate({
			left: '50%'
		}, 200);
		
		two.animate({
			top: '50%'
		}, 200);
		two.animate({
			left: '50%'
		}, 200);
		
		three.animate({
			top: '50%'
		}, 200);
		three.animate({
			left: '50%'
		}, 200);
		
		four.animate({
			top: '50%'
		}, 200);
		four.animate({
			left: '50%'
		}, 200);
		
		five.animate({
			top: '50%'
		}, 200);
		five.animate({
			left: '50%'
		}, 200);
		
		menuIsOpen = false;
		isTop = true;
	}
	$('.bubble').click(function() {
		menuIcon.removeClass('is-active');
		hideBubbles();
		// change 400, 500 to 900, 500
		setTimeout(function() {
			$('#nav').animate({
				top: '80px',
				left: '80px'
			}, 900);
		}, 500);
		isTop = true;
	});

	function doOne() {
		// put menu back then move to hcp page
		setTimeout(function() {
//			window.open("hcp2023.html", "_blank");
	window.location.assign("hcp2023.html");
		}, 1000);
	}

	function doTwo() {
		// put menu back then move to score entry page
  
  /*
		setTimeout(function() {
	//		window.open("scoreentry2023.html", "_blank");
 	window.location.assign("scoreentry2023.html");
		}, 1000);
  */
  
  	window.location.assign("scoreentryloader2023v2.html");
	}

	function doThree() {
		// put menu back then move to twos page
		setTimeout(function() {
	//		window.open("twos2023.html", "_blank");
 window.location.assign("twos2023.html");
		}, 1000);
	}

	function doFour() {
		// put menu back then move to results page
		setTimeout(function() {
		//	window.open("results2023.html", "_blank");
  window.location.assign("results2023.html");
		}, 1000);
	}

	function doFive() {
		// put menu back then move to results page
		setTimeout(function() {
		//	window.open("results2023.html", "_blank");
  window.location.assign("leaderboardloader2023.html");
		}, 1000);
	}


//====================================
// end of menu code
//====================================



//====================================
// runs on start or refresh
//====================================
// see if a new download is necessary
// get todays date eg 26
dd = new Date();
// get date number and format it
d1 = dd.getDate();
if (d1 < 10) {
    d1 = "0" + d1;
}
// get todays month number eg 2
d2 = dd.getMonth();
// create log date eg 26-2
dstored = d1 + "-" + d2;
if ("dstored" in localStorage) {
     if (dstored == localStorage.dstored) {
	afterGetData();
     } else {
            getData();
     }
} else {
     getData();
}


//=====================================
// functions
//=====================================
        // get list of next comps
	function getNextComps() {
		dd = new Date();
		dlist = "";
		dlistcount = 0;
		for(i = 0; i < arrComps.length; i++) {
				
			temptest = arrComps[i].replace("Lakes ", "");
			temptest = temptest.replace("Dawson ", "");
			temptest = temptest.replace("OldCourse ", "");

			// should give something like: 03 June 2023
			darr = new Date(temptest);
			d1 = darr.getDate();
			if(d1 < 10) {
				d1 = "0" + d1;
			}
			d2 = darr.getMonth();
			d3 = darr.getFullYear();
			d4 = darr.getDay();

			
			if(d2 == 0) {
				m = "January";
			}
			if(d2 == 1) {
				m = "February";
			}
			if(d2 == 2) {
				m = "March";
			}
			if(d2 == 3) {
				m = "April";
			}
			if(d2 == 4) {
				m = "May";
			}
			if(d2 == 5) {
				m = "June";
			}
			if(d2 == 6) {
				m = "July";
			}
			if(d2 == 7) {
				m = "August";
			}
			if(d2 == 8) {
				m = "September";
			}
			if(d2 == 9) {
				m = "October";
			}
			if(d2 == 10) {
				m = "November";
			}
			if(d2 == 11) {
				m = "December";
			}
			
			
			if(d4 == 0) {
				d = "Sunday";
			}
			if(d4 == 1) {
				d = "Monday";
			}
			if(d4 == 2) {
				d = "Tuesday";
			}
			if(d4 == 3) {
				d = "Wednesday";
			}
			if(d4 == 4) {
				d = "Thursday";
			}
			if(d4 == 5) {
				d = "Friday";
			}
			if(d4 == 6) {
				d = "Saturday";
			}
			// alert(darr.toString().substring(0,15) + "   " + dd.toString().substring(0,15))
			
			if(darr.toString().substring(0,15) == dd.toString().substring(0,15) && dlistcount < 4) {
				//alert(darr.toString().substring(0,15) + "   " + dd.toString().substring(0,15));
				if (arrComps[i].indexOf("Lakes") > -1) {
					tempd = '<p style="color:white;">Lakes - competition today</p>';
				}
				if (arrComps[i].indexOf("Dawson") > -1) {
					tempd = '<p style="color:white;">Dawson - competition today</p>';
				}
				if (arrComps[i].indexOf("OldCourse") > -1) {
					tempd = '<p style="color:white;">OldCourse - competition today</p>';
				}	
				dlist = dlist + tempd;
				dlistcount++;
			}

			if(darr > dd && dlistcount < 4) {
				tempd = arrComps[i].replace("Lakes ", "Lakes - " + d + " ");
				tempd = tempd.replace("Dawson ", "Dawson - " + d + " ");
				tempd = tempd.replace("OldCourse ", "OldCourse - " + d + " ");
				dlist = dlist + tempd + "<br>";
				dlistcount++;
			}

		}
		document.getElementById("xdcomp1").innerHTML = dlist;
	}
	
        // resize QRcode
	function enlarge() {
		document.getElementById('img').classList.toggle("half");
	}
	


//=====================================
// get data and create arrays
// store in localStorage for retrieval
// and use in scoreentry
//=====================================
async function getData() {
if (!("dstored" in localStorage && dstored == localStorage.dstored)) {
	var dataStream = await fetch("https://opensheet.elk.sh/1W8j2wAuweR0B0fK8cLJZcb2c6cEiOJimFmKdIMcliw4/setupcsv")
	var resultsarray = await dataStream.json()	
	// get rid of blanks in array by creating new arrays
	for(var i = 0; i < resultsarray.length; i++) {
		if(resultsarray[i].players.length > 2) {
			arrPlayers.push(resultsarray[i].players);
			arrHcp.push(resultsarray[i].hcp);
                        // comps is shorter than players and hcps
                        // so cobtains empty items that need to be removed
			sparseArrComps.push(resultsarray[i].comps);
		}
	}
	// remove empty items
	arrComps = sparseArrComps.filter(function (el) {return el != null;});
	
	// overwrite saved data in localStorage
	// players
	localStorage.playersarray = JSON.stringify(arrPlayers);
	// hcps
	localStorage.hcparray = JSON.stringify(arrHcp);
	// comps
	localStorage.compsarray = JSON.stringify(arrComps);

        // tag date to saved data
        localStorage.dstored = dstored

        afterGetData();
       
} else {
       // recover arrays moved to next function
       afterGetData();

}

}	


function afterGetData() {
        
        // retrieve arrays
        // only comps is needed here
	//if ("playersarray" in localStorage) {
	//    arrPlayers = JSON.parse(localStorage.playersarray);
	//}
	//if ("hcparray" in localStorage) {
	//    arrHcp = JSON.parse(localStorage.hcparray);
	//}
	if ("compsarray" in localStorage) {
	    arrComps = JSON.parse(localStorage.compsarray);
	}
	
//	for(var i = 0; i < arrPlayers.length; i++) {
//	    console.log(arrPlayers[i], arrHcp[i])
//	}
              
        getNextComps();
      
}
	
	</script>
	</body>

</html>

