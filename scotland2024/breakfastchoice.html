<!DOCTYPE html>
<html>
   <head>
      <meta charset="UTF-8">
      <meta content="width=device-width, initial-scale=1.0" name="viewport">
      <meta content="ie=edge" http-equiv="X-UA-Compatible">
      <title>breakfast</title>
      <link href='https://fonts.googleapis.com/css?family=Kalam' rel='stylesheet'>
      <link href='https://fonts.googleapis.com/css?family=Kalam' rel='stylesheet'>
      <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>
      <style>
         * {
         margin: 0;
         padding: 0;
         box-sizing: border-box;
         }
         html {
         height: 100%;
         min-height: 100%;
         width: 100%;
         min-width: 100%;
         }
         body {
         //overflow: hidden;
         font-family: Arial, Helvetica, sans-serif;
         font-size: 3vh;
         background: black;
         height: 100%;
         width: 100%;
         }
         /* dropdown */
         #dropbtn {
         color: yellow; //white;
         background: dodgerBlue;
         height: 100%;
         display: flex;
         justify-content: center;
         align-items: center;
         border-radius: 5px;
         background: dodgerBlue;
         color: white;
         padding: 2vh 1vh;
         font-size: 3vh;
         }
         .dropdown {
         position: relative;
         display: inline-block;
         }
         .dropdown-content {
         display: none;
         position: absolute;
         background-color: black;
         min-width: 160px;
         overflow: auto;
         z-index: 1;
         border-radius: 5px;
         max-height: 70vh;
         }
         .dropdown-content a {
         color: black;
         font-size: 4vh;
         background: whiteSmoke;
         padding: 12px 16px;
         text-decoration: none;
         display: block;
         border: 1px solid gray;
         }
         .show {
         display: block;
         }
         #name {
         color: white;
         font-size: 3vh;
         padding: 2vh 1vh;
         }    
         .btn {
         background: dodgerBlue;
         color: white;
         padding: 2vh 1vh;
         font-size: 3vh;
         border-radius: 5px;
         //margin: 1vh;
         display: flex;
         justify-content: center;
         align-items: center;
         width: 100%;
         }    
         #txtlist {
         color: yellow;
         font-size: 3vh;
         }
         #my-response-iframe, #my-form {
         display: none;
         } 
         .spacer1 {
         height: 2vh;   
         }
         #msg {
         position: absolute;
         top: 2vh;
         left: 2vw;
         width: 96vw;
         font-size: 3vh;
         color: white;
         background: black;
         padding: 10vh 2vw;
         box-shadow: 10px 10px 25px black;
         border-radius: 5px;
         }
         #counter {
         color: white;
         font-size: 2.5vh;   
         padding: 2vh 1vh;
         }
         
.title {
font-size: 3vh;
color: white;
padding: 2vh 1vh;
}         

#submitbutton, #dropbtn {
color: yellow;
}
         
      </style>
   </head>
   <body>
      <div id="msg" onclick="closemsg()">Pre-order breakfast, change your selection by selecting and unselecting items. The process takes a couple of seconds but the listing will take about 30 seconds to display. Repeat the process if you wish to change selections.
         <br><br>
         1. Select name
         <br>
         2. Select food
         <br>
         3. Confirm
         <br>
         4. Your selection will be displayed at the bottom of the screen within around 30 seconds.         
         <br><br><br>tap to close this message 
      </div>
      <div>
      <div class="title">1 - Select your name</div>
         <button onclick="toggleDropdown()" class="dropbtn btn" id="dropbtn">
            Select your name
         </button>
         <div id="playersDropdown" class="dropdown-content"></div>
      </div>
      <div id="name"></div>
      <div class="spacer1">&nbsp;</div>
      <button class="btn" id="btn0">no one selected to choose breakfast</button>
      <div class="spacer1">&nbsp;</div>
      <div class="title">2 - Select any items from below</div>
      <button onclick="myfood(this.id)" class="btn" id="btn1">breakfast bap - bacon £4.00</button>
      <button onclick="myfood(this.id)" class="btn" id="btn2">breakfast bap - sausage £4.00</button>
      <button onclick="myfood(this.id)" class="btn" id="btn3">breakfast bap - egg £4.00</button>
      <button onclick="myfood(this.id)" class="btn" id="btn4">breakfast bap - bacon & mushroom £4.75</button>
      <button onclick="myfood(this.id)" class="btn" id="btn5">breakfast bap - sausage & mushroom £4.75</button>
      <button onclick="myfood(this.id)" class="btn" id="btn6">breakfast bap - egg & mushroom £4.75</button>
      <button onclick="myfood(this.id)" class="btn" id="btn7">breakfast bap - bacon & tomato £4.75</button>
      <button onclick="myfood(this.id)" class="btn" id="btn8">breakfast bap - sausage & tomato £4.75</button>
      <button onclick="myfood(this.id)" class="btn" id="btn9">breakfast bap - egg & tomato 4.75</button>
      <button onclick="myfood(this.id)" class="btn" id="btn10">tower bap - bacon, sausage, egg & hash brown £6.00</button>
      <button onclick="myfood(this.id)" class="btn" id="btn11">9 hole breakfast - bacon, egg, potato waffle & beans £5.50</button>
      <button onclick="myfood(this.id)" class="btn" id="btn12">18 hole breakfast - bacon, sausage, egg, tomato, black pudding, potato waffle, beans & toast £8.00</button>
      <button onclick="myfood(this.id)" class="btn" id="btn13">beans on toast £3.00</button>
      <button onclick="myfood(this.id)" class="btn" id="btn14">scrambled egg on toast £3.00</button>
      <button onclick="myfood(this.id)" class="btn" id="btn15">toast & strawberry jam £2.00</button>
      <button onclick="myfood(this.id)" class="btn" id="btn16">toast & raspberry jam £2.00</button>
      <button onclick="myfood(this.id)" class="btn" id="btn17">toast & blackcurrant jam £2.00</button>
      <button onclick="myfood(this.id)" class="btn" id="btn18">coffee £1.90</button>
      <button onclick="myfood(this.id)" class="btn" id="btn19">no breakfast</button>
      </div>
      <div class="spacer1">&nbsp;</div>
      <div class="title">3 - Confirm selection</div>
      <button class="btn" id="submitbutton"onclick="submitForm()">
         confirm breakfast selection
      </button>
      <div id="counter">
      </div>
      <!-- invisible but necessary for submit of data
         form to construct data prior to submit -->
      <form action="https://docs.google.com/forms/d/e/1FAIpQLScnURRwj4s2rnJag2LegqbUXzcjASUI1SltYMcOgJQRud4wrw/formResponse" id="my-form" method="post" name="my-form" target="my-response-iframe">
         <!-- name, food -->
         <input id='mx3455305' name='entry.3455305' type='text' value='default'>
         <input id='mx1713138291' name='entry.1713138291' type='text' value='default'>
         <input type="submit"> 
      </form>
      <!-- google iframe inserted here - invisible -->
      <iframe height="20" id="my-response-iframe" name="my-response-iframe" src="https://docs.google.com/forms/d/e/1FAIpQLScnURRwj4s2rnJag2LegqbUXzcjASUI1SltYMcOgJQRud4wrw/viewform?embedded=true" width="60"></iframe>
      <br>
      <a id="txtlist"></a>
      <!--
         <iframe src="https://docs.google.com/spreadsheets/d/e/2PACX-1vRDLdqGJy60FNrnlQeH3XIXOEZAJua0LpDIbZmppl_2tYT4Vzy2Nf1qDnGUxS14HIwUcFNNBb21AEQ5/pubhtml?gid=435825355&amp;single=true&amp;widget=true&amp;headers=false"></iframe>
         -->
      <br><br><br><br>
      <script>
         /*
         
         pre filled form
         
         
         https://docs.google.com/forms/d/e/1FAIpQLScnURRwj4s2rnJag2LegqbUXzcjASUI1SltYMcOgJQRud4wrw/viewform?usp=pp_url&entry.3455305=namex&entry.1713138291=foodx
         
         */
         
         
         
         
         var playername ="";
         var foodname = "";
         
         
         
         
         
         
         
         arrOptions = [
         "Stephen Alldridge",
         "Keith Belshaw",
         "Paul Burt",
         "Trevor Charlton",
         "Chris Chelton",
         "Ken Clark",
         "Andy Clough",
         "Bryan Craggs",
         "Andy Davison",
         "John Dean",
         "Peter Dodds",
         "Eileen Gow",
         "Graeme Gow",
         "Clive Herbert",
         "Eddie Hicks",
         "Barry Hill",
         "Peter Holleran",
         "Martin Leonard",
         "Bryan Maddison",
         "Bob Nicholas",
         "Dean Pearson",
         "Dean Phillips",
         "Gary Scott",
         "Tony Smith"
         ]
         
         
         
         // get the current list
         getData()
         
         
         
          //=====================================================
             // Close the dropdown if the user clicks outside of it
             //=====================================================
             window.onclick = function(event) {
               if (!event.target.matches('.dropbtn')) {
                 var dropdowns = document.getElementsByClassName("dropdown-content");
                 var i;
                 for (i = 0; i < dropdowns.length; i++) {
                   var openDropdown = dropdowns[i];
                   if (openDropdown.classList.contains('show')) {
                     openDropdown.classList.remove('show');
                   }
                 }
               }
             };
         
         
         
         
         
         
         
           // create a new player dropdown
               var select = document.getElementById("playersDropdown");
               // this is what is created
               //<a id="myLink1" href="#" onclick='dropSelected(this.innerText);return false;'>Bryan Maddison</a>
               //
               for (var i = 0; i < arrOptions.length; i++) {
                 var el = document.createElement("a");
                 el.id = "myLink" + (i);
                 el.setAttribute("onclick", "dropSelected(this.innerText);return false;");
                 el.setAttribute("href", "#");
                 el.innerText = arrOptions[i];
                 select.appendChild(el);
                 
               }
         
         
          //=============================================================
             // function toggleDropdown()
             // - show player name choices
             //=============================================================  
             function toggleDropdown() {
               // When the user clicks on the button, toggle between hiding and showing the dropdown content
               document.getElementById("playersDropdown").classList.toggle("show");
             }
         
            // name selected, do stuff
             function dropSelected(playerNamex) {
             // update global var
             playername = playerNamex;
              document.getElementById("btn0").innerText = playerNamex + " choosing breakfast"
              document.getElementById("btn0").style.background = "blue";
           }
         
         
         
         
         //=============================================================
             // function submitForm()
             // - send info from HTML form to google form
             //=============================================================  
             function submitForm() {
              // reset all food choices       
              for (i = 1; i <= 19; i++) {
                   if (document.getElementById("btn" + i).style.background == "blue"){
                       // update global food list var
                       if (foodname == "") {
                           foodname += document.getElementById("btn" + i).innerText
                       } else {
                           foodname += "#" + document.getElementById("btn" + i).innerText
                       }
                       // reset background color
                       document.getElementById("btn" + i).style.background = "dodgerBlue";          
                   }
              }
              
                   document.getElementById("btn0").style.background = "dodgerBlue"; 
              
                   document.getElementById('mx3455305').value = playername;
                   document.getElementById('mx1713138291').value = foodname;
              
                   
                   //===== submit data ==========
                   //============================
                   document.forms[0].submit();
                   document.getElementById("submitbutton").style.background = "blue";
                   setTimeout(function() {
                      document.getElementById("submitbutton").style.background = "dodgerBlue";
                      getData();
                   }, 1000)
                   
         // reset all
         //for (i = 0; i <= 18; i++) {
         // document.getElementById("btn" + i).style.background = "dodgerBlue";          
         //}         
                   
         document.getElementById("btn0").innerText = "no one selected to choose breakfast";       
             
         playername ="";
         foodname = "";
               
           
            
         var s = 0;
         var id = setInterval(frame, 1000);
           
           function frame() {
             if (s == 30) {
               s = 0;
               getData();
               clearInterval(id);       
               document.getElementById("counter").innerText = "";
             } else {
               s++
               document.getElementById("counter").innerText = "next list update in " + (30 - s) + " seconds"
             }
           }
                   
         }
         
         
         function myfood(id) {
         
         // update selected choice  
         if (document.getElementById(id).style.background == "blue") {       
              document.getElementById(id).style.background = "dodgerBlue";  
         } else {
              document.getElementById(id).style.background = "blue";
         }
         
         
         }
         
         
         
         
         
         /*
         shared csv link
         https://docs.google.com/spreadsheets/d/e/2PACX-1vRDLdqGJy60FNrnlQeH3XIXOEZAJua0LpDIbZmppl_2tYT4Vzy2Nf1qDnGUxS14HIwUcFNNBb21AEQ5/pub?gid=435825355&single=true&output=csv
         */
             async function getData() {
               console.log("here - getdata")
               var dataStream = await fetch("https://opensheet.elk.sh/1WCMMo2dd0TSZ8Lts8ymmPXmmXSdNibDBWRZVUnb4LOs/selectedcsv")
         
               if (!dataStream.ok) {
                 const message = `An error has occured: ${dataStream.status}`;
                 //throw new Error(message);
                 alert("error 3: " + message)
               }
         
               var resultsarray = await dataStream.json()
               // split into separate arrays
               arrNames = resultsarray.map(d => d.names);
               arrFood = resultsarray.map(d => d.food);
               
               // remove null items
               arrNames = arrNames.filter(function(el) {
                 return el != null;
               })
               arrFood = arrFood.filter(function(el) {
                 return el != null;
               })
               
         
               // remove empty items
               arrNames = arrNames.filter(function(el) {
                 return el != "";
               })
               arrFood = arrFood.filter(function(el) {
                 return el != "";
               })
               
         
         
         
         
         // loop through list
         var txt = "";      
               for (i = 0; i < arrNames.length; i++) {
                 
               txt += arrNames[i] + "\n" + arrFood[i].replaceAll("#","\n") + "\n\n"
               
               }
         
         
         document.getElementById("txtlist").innerText = txt;
         
         
             }
             
         
         
         function closemsg() {
         document.getElementById("msg").style.display = "none";
         }
         
         
         
         
         
         
         
      </script>
   </body>
